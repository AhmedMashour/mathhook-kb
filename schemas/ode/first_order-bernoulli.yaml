topic: "ode"
title: "Bernoulli Differential Equations"
description: "Solve nonlinear first-order Bernoulli differential equations using substitution methods with MathHook"

mathematical_definition: "\\frac{dy}{dx} + P(x)y = Q(x)y^n"

quick_reference:
  standard_form: "$\\frac{dy}{dx} + P(x)y = Q(x)y^n$ where $n \\neq 0, 1$"
  substitution: "$v = y^{1-n}$"
  method: "Transform to linear equation in $v$"
  solution_steps:
    - "Identify $P(x)$, $Q(x)$, and $n$"
    - "Make substitution $v = y^{1-n}$"
    - "Solve resulting linear equation"
    - "Back-substitute to find $y$"

examples:
  - title: "Basic Bernoulli Equation"
    explanation: |
      Solve the Bernoulli equation: $\frac{dy}{dx} + y = xy^2$

      **Step 1**: Identify parameters
      - $P(x) = 1$
      - $Q(x) = x$
      - $n = 2$

      **Step 2**: Make substitution $v = y^{1-2} = y^{-1}$
      Then $\frac{dv}{dx} = -y^{-2}\frac{dy}{dx}$

      **Step 3**: Transform equation
      Multiply original by $-y^{-2}$:
      $-y^{-2}\frac{dy}{dx} - y^{-1} = -x$

      This becomes: $\frac{dv}{dx} - v = -x$

      **Step 4**: Solve linear equation
      Integrating factor: $\mu(x) = e^{-x}$
      Solution: $v = -x - 1 + Ce^x$

      **Step 5**: Back-substitute
      $y^{-1} = -x - 1 + Ce^x$
      $y = \frac{1}{-x - 1 + Ce^x}$
    code:
      python: |
        from mathhook import symbol, expr, solve_ode

        x = symbol('x')
        y = symbol('y', function_of=x)

        # dy/dx + y = x*y^2
        equation = expr(y.diff(x) + y - x*y**2)
        solution = solve_ode(equation, y)
        print(f"Solution: {solution}")
      rust: |
        use mathhook_core::{symbol, expr, solve_ode};

        let x = symbol!(x);
        let y = symbol!(y);  // Function of x

        // dy/dx + y = x*y^2
        let equation = expr!(derivative(y, x) + y - x*(y^2));
        let solution = solve_ode(&equation, &y);
        println!("Solution: {}", solution);
      nodejs: |
        const { symbol, expr, solveODE } = require('mathhook-node');

        const x = symbol('x');
        const y = symbol('y', { functionOf: x });

        // dy/dx + y = x*y^2
        const equation = expr(y.diff(x).add(y).sub(x.mul(y.pow(2))));
        const solution = solveODE(equation, y);
        console.log(`Solution: ${solution}`);

  - title: "Bernoulli with Negative Power"
    explanation: |
      Solve: $\frac{dy}{dx} - 2xy = -x y^{-1}$

      Here $n = -1$, so substitution is $v = y^{1-(-1)} = y^2$

      This transforms to: $\frac{dv}{dx} - 4xv = -2x$

      A linear equation we can solve with integrating factor.
    code:
      python: |
        from mathhook import symbol, expr, solve_ode

        x = symbol('x')
        y = symbol('y', function_of=x)

        # dy/dx - 2xy = -x*y^(-1)
        equation = expr(y.diff(x) - 2*x*y + x*y**(-1))
        solution = solve_ode(equation, y)
        print(f"Solution: {solution}")
      rust: |
        use mathhook_core::{symbol, expr, solve_ode};

        let x = symbol!(x);
        let y = symbol!(y);

        // dy/dx - 2xy = -x*y^(-1)
        let equation = expr!(derivative(y, x) - (2*x*y) + (x*(y^(-1))));
        let solution = solve_ode(&equation, &y);
        println!("Solution: {}", solution);
      nodejs: |
        const { symbol, expr, solveODE } = require('mathhook-node');

        const x = symbol('x');
        const y = symbol('y', { functionOf: x });

        // dy/dx - 2xy = -x*y^(-1)
        const equation = expr(y.diff(x).sub(expr(2).mul(x).mul(y)).add(x.mul(y.pow(-1))));
        const solution = solveODE(equation, y);
        console.log(`Solution: ${solution}`);

article:
  sections:
    - title: "What is a Bernoulli Equation?"
      content: |
        ### Definition ###

        A **Bernoulli differential equation** has the form:

        $$\frac{dy}{dx} + P(x)y = Q(x)y^n$$

        where:
        - $P(x)$ and $Q(x)$ are functions of $x$
        - $n$ is a real number (typically $n \neq 0, 1$)

        ### Special Cases ###

        - When $n = 0$: Reduces to linear equation $\frac{dy}{dx} + P(x)y = Q(x)$
        - When $n = 1$: Separable equation $\frac{dy}{dx} = (Q(x) - P(x))y$
        - When $n \neq 0, 1$: True Bernoulli equation requiring substitution

    - title: "The Substitution Method"
      content: |
        ### Why Substitution Works ###

        The Bernoulli equation is **nonlinear** due to the $y^n$ term. The key insight is to make a substitution that transforms it into a **linear** equation.

        ### Standard Substitution ###

        Let $v = y^{1-n}$

        Then:
        $$\frac{dv}{dx} = (1-n)y^{-n}\frac{dy}{dx}$$

        ### Transformation Steps ###

        1. **Multiply** the original equation by $(1-n)y^{-n}$:
           $$(1-n)y^{-n}\frac{dy}{dx} + (1-n)P(x)y^{1-n} = (1-n)Q(x)$$

        2. **Recognize** that the left side is $\frac{dv}{dx} + (1-n)P(x)v$

        3. **Result**: Linear equation in $v$:
           $$\frac{dv}{dx} + (1-n)P(x)v = (1-n)Q(x)$$

        4. **Solve** using integrating factor method

        5. **Back-substitute**: $v = y^{1-n}$ to find $y$

    - title: "Solution Strategy"
      content: |
        ### Step-by-Step Process ###

        **Given**: $\frac{dy}{dx} + P(x)y = Q(x)y^n$

        **Step 1: Identify Parameters**
        - Extract $P(x)$, $Q(x)$, and $n$
        - Verify $n \neq 0, 1$ (otherwise different method)

        **Step 2: Make Substitution**
        - Set $v = y^{1-n}$
        - Compute $\frac{dv}{dx} = (1-n)y^{-n}\frac{dy}{dx}$

        **Step 3: Transform Equation**
        - Multiply original by $(1-n)y^{-n}$
        - Express in terms of $v$ and $\frac{dv}{dx}$

        **Step 4: Solve Linear Equation**
        - Use integrating factor: $\mu(x) = e^{\int (1-n)P(x)dx}$
        - Solve: $v = e^{-\int (1-n)P(x)dx}\left[\int (1-n)Q(x)e^{\int (1-n)P(x)dx}dx + C\right]$

        **Step 5: Back-Substitute**
        - Replace $v$ with $y^{1-n}$
        - Solve for $y$: $y = v^{\frac{1}{1-n}}$

    - title: "Common Patterns"
      content: |
        ### Pattern 1: Population Growth with Limiting Factor ###

        Equation: $\frac{dP}{dt} = rP - kP^2$

        This is Bernoulli with $n = 2$:
        - Rewrite as: $\frac{dP}{dt} - rP = -kP^2$
        - Substitution: $v = P^{-1}$
        - Models population with carrying capacity

        ### Pattern 2: Chemical Reactions ###

        Equation: $\frac{dC}{dt} = k_1 - k_2C^2$

        Bernoulli form with $n = 2$:
        - Common in autocatalytic reactions
        - $v = C^{-1}$ linearizes the equation

        ### Pattern 3: Electric Circuits ###

        RL circuit with nonlinear resistor:
        $L\frac{dI}{dt} + RI = VI^{-1}$

        Bernoulli with $n = -1$

    - title: "Special Techniques"
      content: |
        ### When $n$ is Negative ###

        For $n < 0$, the equation is still Bernoulli but substitution is:
        $v = y^{1-n}$ where $1-n > 1$

        Example: $n = -1 \Rightarrow v = y^2$

        ### When $n$ is Rational ###

        For $n = \frac{p}{q}$, the substitution $v = y^{1-\frac{p}{q}}$ may involve fractional powers.

        Sometimes easier to use $w = y^q$ to avoid fractions.

        ### Reduction to Bernoulli ###

        Some equations can be **transformed** into Bernoulli form:

        $$x\frac{dy}{dx} + P(x)y = Q(x)y^n$$

        Can be converted by substitution $t = \ln x$

    - title: "Verification of Solutions"
      content: |
        ### Always Verify ###

        After solving, **substitute back** into original equation:

        1. Compute $\frac{dy}{dx}$ from your solution
        2. Substitute $y$ and $\frac{dy}{dx}$ into $\frac{dy}{dx} + P(x)y = Q(x)y^n$
        3. Simplify and verify both sides are equal

        ### Check Boundary Conditions ###

        - If initial condition $y(x_0) = y_0$ is given, verify it's satisfied
        - Ensure solution doesn't have singularities in the domain of interest

        ### Domain Considerations ###

        - Solution $y = v^{\frac{1}{1-n}}$ may have restrictions
        - For $n > 1$: $v$ must be positive if $\frac{1}{1-n}$ has even denominator
        - Check where solution is defined and continuous

related_topics:
  - slug: "ode-first_order-linear"
    title: "Linear First-Order ODEs"
    description: "Foundation for Bernoulli method"
  - slug: "ode-first_order-separable"
    title: "Separable Differential Equations"
    description: "Alternative method for some Bernoulli cases"
  - slug: "calculus-integration"
    title: "Integration Techniques"
    description: "Required for solving transformed equation"

references:
  - title: "Ordinary Differential Equations"
    author: "Morris Tenenbaum and Harry Pollard"
    year: 1985
    publisher: "Dover Publications"
  - title: "Elementary Differential Equations"
    author: "William E. Boyce and Richard C. DiPrima"
    year: 2017
    publisher: "Wiley"
  - title: "Differential Equations with Applications and Historical Notes"
    author: "George F. Simmons"
    year: 2016
    publisher: "CRC Press"
