topic: "ode"
title: "Exact Differential Equations"
description: "Solve exact first-order differential equations using potential function methods with MathHook"

mathematical_definition: "M(x,y)dx + N(x,y)dy = 0 \\text{ where } \\frac{\\partial M}{\\partial y} = \\frac{\\partial N}{\\partial x}"

quick_reference:
  standard_form: "$M(x,y)dx + N(x,y)dy = 0$"
  exactness_test: "$\\frac{\\partial M}{\\partial y} = \\frac{\\partial N}{\\partial x}$"
  solution_method: "Find potential function $F(x,y)$ where $F_x = M$ and $F_y = N$"
  solution_form: "$F(x,y) = C$"
  solution_steps:
    - "Verify exactness condition"
    - "Integrate $M$ with respect to $x$"
    - "Differentiate result with respect to $y$"
    - "Compare with $N$ to find integration constant"
    - "Write solution as $F(x,y) = C$"

examples:
  - title: "Basic Exact Equation"
    explanation: |
      Solve: $(2x + y)dx + (x + 2y)dy = 0$

      **Step 1**: Check exactness
      - $M(x,y) = 2x + y$, so $\frac{\partial M}{\partial y} = 1$
      - $N(x,y) = x + 2y$, so $\frac{\partial N}{\partial x} = 1$
      - Since $\frac{\partial M}{\partial y} = \frac{\partial N}{\partial x}$, the equation is exact!

      **Step 2**: Find potential function $F(x,y)$
      Integrate $M$ with respect to $x$:
      $$F(x,y) = \int (2x + y)dx = x^2 + xy + g(y)$$

      **Step 3**: Determine $g(y)$
      We need $\frac{\partial F}{\partial y} = N$:
      $$\frac{\partial F}{\partial y} = x + g'(y) = x + 2y$$

      So $g'(y) = 2y$, which gives $g(y) = y^2$

      **Step 4**: Complete solution
      $F(x,y) = x^2 + xy + y^2$

      **Solution**: $x^2 + xy + y^2 = C$
    code:
      python: |
        from mathhook import symbol, expr, solve_exact_ode

        x, y = symbol('x'), symbol('y')

        # (2x + y)dx + (x + 2y)dy = 0
        M = expr(2*x + y)
        N = expr(x + 2*y)

        solution = solve_exact_ode(M, N, x, y)
        print(f"Solution: {solution}")

        # Verify exactness
        from mathhook import diff
        dM_dy = diff(M, y)
        dN_dx = diff(N, x)
        print(f"Exactness check: ∂M/∂y = {dM_dy}, ∂N/∂x = {dN_dx}")
      rust: |
        use mathhook_core::{symbol, expr, solve_exact_ode, diff};

        let x = symbol!(x);
        let y = symbol!(y);

        // (2x + y)dx + (x + 2y)dy = 0
        let M = expr!(2*x + y);
        let N = expr!(x + 2*y);

        let solution = solve_exact_ode(&M, &N, &x, &y);
        println!("Solution: {}", solution);

        // Verify exactness
        let dM_dy = diff(&M, &y);
        let dN_dx = diff(&N, &x);
        println!("Exactness: ∂M/∂y = {}, ∂N/∂x = {}", dM_dy, dN_dx);
      nodejs: |
        const { symbol, expr, solveExactODE, diff } = require('mathhook-node');

        const x = symbol('x'), y = symbol('y');

        // (2x + y)dx + (x + 2y)dy = 0
        const M = expr(expr(2).mul(x).add(y));
        const N = expr(x.add(expr(2).mul(y)));

        const solution = solveExactODE(M, N, x, y);
        console.log(`Solution: ${solution}`);

        // Verify exactness
        const dM_dy = diff(M, y);
        const dN_dx = diff(N, x);
        console.log(`Exactness: ∂M/∂y = ${dM_dy}, ∂N/∂x = ${dN_dx}`);

  - title: "Exact Equation with Non-Exact Form (Using Integrating Factor)"
    explanation: |
      Sometimes an equation is **not exact** but can be made exact with an integrating factor.

      Solve: $ydx - xdy = 0$

      **Check exactness**:
      - $M = y$, $\frac{\partial M}{\partial y} = 1$
      - $N = -x$, $\frac{\partial N}{\partial x} = -1$
      - Not exact since $1 \neq -1$

      **Find integrating factor**: Try $\mu(x,y) = \frac{1}{y^2}$

      Multiply equation: $\frac{y}{y^2}dx - \frac{x}{y^2}dy = 0$

      Simplifies to: $\frac{1}{y}dx - \frac{x}{y^2}dy = 0$

      **New check**:
      - $M = \frac{1}{y}$, $\frac{\partial M}{\partial y} = -\frac{1}{y^2}$
      - $N = -\frac{x}{y^2}$, $\frac{\partial N}{\partial x} = -\frac{1}{y^2}$
      - Now exact!

      **Solve**:
      $F(x,y) = \int \frac{1}{y}dx = \frac{x}{y} + g(y)$

      $\frac{\partial F}{\partial y} = -\frac{x}{y^2} + g'(y) = -\frac{x}{y^2}$

      So $g'(y) = 0$, giving $g(y) = $ constant

      **Solution**: $\frac{x}{y} = C$ or $x = Cy$
    code:
      python: |
        from mathhook import symbol, expr, find_integrating_factor, solve_exact_ode

        x, y = symbol('x'), symbol('y')

        # y*dx - x*dy = 0
        M = expr(y)
        N = expr(-x)

        # Find integrating factor
        mu = find_integrating_factor(M, N, x, y)
        print(f"Integrating factor: {mu}")

        # Multiply and solve
        M_new = M * mu
        N_new = N * mu
        solution = solve_exact_ode(M_new, N_new, x, y)
        print(f"Solution: {solution}")
      rust: |
        use mathhook_core::{symbol, expr, find_integrating_factor, solve_exact_ode};

        let x = symbol!(x);
        let y = symbol!(y);

        // y*dx - x*dy = 0
        let M = expr!(y);
        let N = expr!(-x);

        // Find integrating factor
        let mu = find_integrating_factor(&M, &N, &x, &y);
        println!("Integrating factor: {}", mu);

        // Multiply and solve
        let M_new = expr!(M * mu);
        let N_new = expr!(N * mu);
        let solution = solve_exact_ode(&M_new, &N_new, &x, &y);
        println!("Solution: {}", solution);
      nodejs: |
        const { symbol, expr, findIntegratingFactor, solveExactODE } = require('mathhook-node');

        const x = symbol('x'), y = symbol('y');

        // y*dx - x*dy = 0
        const M = expr(y);
        const N = expr(x.neg());

        // Find integrating factor
        const mu = findIntegratingFactor(M, N, x, y);
        console.log(`Integrating factor: ${mu}`);

        // Multiply and solve
        const M_new = M.mul(mu);
        const N_new = N.mul(mu);
        const solution = solveExactODE(M_new, N_new, x, y);
        console.log(`Solution: ${solution}`);

article:
  sections:
    - title: "What is an Exact Differential Equation?"
      content: |
        ### Definition ###

        An **exact differential equation** has the form:

        $$M(x,y)dx + N(x,y)dy = 0$$

        where there exists a function $F(x,y)$ such that:

        $$dF = \frac{\partial F}{\partial x}dx + \frac{\partial F}{\partial y}dy = M(x,y)dx + N(x,y)dy$$

        This means:
        - $\frac{\partial F}{\partial x} = M(x,y)$
        - $\frac{\partial F}{\partial y} = N(x,y)$

        ### Why "Exact"? ###

        The equation is called "exact" because the left side is an **exact differential** - it's the total differential of some function $F(x,y)$.

        When this is true, the equation $dF = 0$ immediately integrates to:
        $$F(x,y) = C$$

        This is the **implicit solution**.

    - title: "The Exactness Test"
      content: |
        ### How to Check Exactness ###

        Given: $M(x,y)dx + N(x,y)dy = 0$

        The equation is exact **if and only if**:

        $$\frac{\partial M}{\partial y} = \frac{\partial N}{\partial x}$$

        ### Why This Works ###

        If $F(x,y)$ exists with $F_x = M$ and $F_y = N$, then by the equality of mixed partials:

        $$\frac{\partial^2 F}{\partial y \partial x} = \frac{\partial^2 F}{\partial x \partial y}$$

        which gives:

        $$\frac{\partial M}{\partial y} = \frac{\partial N}{\partial x}$$

        ### Practical Test ###

        1. Compute $\frac{\partial M}{\partial y}$
        2. Compute $\frac{\partial N}{\partial x}$
        3. If equal: exact! Proceed to find $F(x,y)$
        4. If not equal: not exact, need integrating factor

    - title: "Finding the Potential Function"
      content: |
        ### Method 1: Integrate $M$ with respect to $x$ ###

        **Step 1**: Integrate $M(x,y)$ with respect to $x$, treating $y$ as constant:
        $$F(x,y) = \int M(x,y)dx + g(y)$$

        Here $g(y)$ is an arbitrary function of $y$ (the "constant" of integration).

        **Step 2**: Differentiate with respect to $y$:
        $$\frac{\partial F}{\partial y} = \frac{\partial}{\partial y}\left[\int M(x,y)dx\right] + g'(y)$$

        **Step 3**: Set equal to $N(x,y)$:
        $$\frac{\partial}{\partial y}\left[\int M(x,y)dx\right] + g'(y) = N(x,y)$$

        **Step 4**: Solve for $g'(y)$:
        $$g'(y) = N(x,y) - \frac{\partial}{\partial y}\left[\int M(x,y)dx\right]$$

        **Step 5**: Integrate to find $g(y)$:
        $$g(y) = \int g'(y)dy$$

        **Step 6**: Write complete solution:
        $$F(x,y) = \int M(x,y)dx + g(y) = C$$

        ### Method 2: Integrate $N$ with respect to $y$ ###

        Alternatively, start by integrating $N$ with respect to $y$:
        $$F(x,y) = \int N(x,y)dy + h(x)$$

        Then determine $h(x)$ by setting $\frac{\partial F}{\partial x} = M(x,y)$.

        Both methods give the same result.

    - title: "Integrating Factors"
      content: |
        ### When Equation is Not Exact ###

        If $\frac{\partial M}{\partial y} \neq \frac{\partial N}{\partial x}$, the equation is **not exact**.

        However, we can multiply by an **integrating factor** $\mu(x,y)$ to make it exact:

        $$\mu(x,y)M(x,y)dx + \mu(x,y)N(x,y)dy = 0$$

        ### Finding Integrating Factors ###

        **Case 1**: $\mu$ depends only on $x$, i.e., $\mu = \mu(x)$

        Condition:
        $$\frac{1}{N}\left(\frac{\partial M}{\partial y} - \frac{\partial N}{\partial x}\right) = f(x) \text{ (function of $x$ only)}$$

        Then:
        $$\mu(x) = e^{\int f(x)dx}$$

        **Case 2**: $\mu$ depends only on $y$, i.e., $\mu = \mu(y)$

        Condition:
        $$\frac{1}{M}\left(\frac{\partial N}{\partial x} - \frac{\partial M}{\partial y}\right) = g(y) \text{ (function of $y$ only)}$$

        Then:
        $$\mu(y) = e^{\int g(y)dy}$$

        ### Common Integrating Factors ###

        - $\mu = \frac{1}{xy}$
        - $\mu = \frac{1}{x^2 + y^2}$
        - $\mu = \frac{1}{x^2}$ or $\frac{1}{y^2}$
        - $\mu = x^n$ or $y^n$ for some integer $n$

    - title: "Geometric Interpretation"
      content: |
        ### Level Curves ###

        The solution $F(x,y) = C$ represents a **family of level curves** of the function $F$.

        Each value of $C$ gives a different curve, and these curves fill the $xy$-plane.

        ### Direction Field ###

        The equation $M(x,y)dx + N(x,y)dy = 0$ can be rewritten as:
        $$\frac{dy}{dx} = -\frac{M(x,y)}{N(x,y)}$$

        This defines a **direction field** where the slope at each point $(x,y)$ is $-M/N$.

        ### Orthogonal Trajectories ###

        The curves $F(x,y) = C$ are **orthogonal trajectories** to the curves given by:
        $$N(x,y)dx - M(x,y)dy = 0$$

        This means the two families of curves intersect at right angles.

    - title: "Common Patterns and Tricks"
      content: |
        ### Pattern 1: Homogeneous Coefficients ###

        If $M$ and $N$ are homogeneous of the same degree, the equation might be exact or have a simple integrating factor.

        Example: $M = x^2 - y^2$, $N = 2xy$ (both degree 2)

        ### Pattern 2: Products of Functions ###

        Equations like $x^n y^m dx + x^p y^q dy = 0$ often have integrating factors of the form $\mu = x^a y^b$.

        ### Pattern 3: Exact After Rearrangement ###

        Sometimes rearranging terms makes exactness obvious:

        $(y + 2x)dx + xdy = 0$ can be rewritten as $ydx + xdy + 2xdx = 0$

        Notice $ydx + xdy = d(xy)$, so this becomes $d(xy) + 2xdx = 0$.

        ### Pattern 4: Grouping Terms ###

        Look for combinations like:
        - $ydx + xdy = d(xy)$
        - $\frac{ydx - xdy}{y^2} = d\left(\frac{x}{y}\right)$
        - $\frac{xdy - ydx}{x^2} = d\left(\frac{y}{x}\right)$
        - $\frac{xdy - ydx}{x^2 + y^2} = d\left(\arctan\frac{y}{x}\right)$

    - title: "Verification and Special Cases"
      content: |
        ### Verifying Solutions ###

        After finding $F(x,y) = C$, verify:

        1. **Check exactness**: $\frac{\partial M}{\partial y} = \frac{\partial N}{\partial x}$ (or with integrating factor)
        2. **Check $F_x = M$**: Differentiate $F$ with respect to $x$
        3. **Check $F_y = N$**: Differentiate $F$ with respect to $y$
        4. **Substitute initial conditions**: If $y(x_0) = y_0$, find $C$

        ### Singular Solutions ###

        Sometimes the equation $\frac{\partial M}{\partial y} = \frac{\partial N}{\partial x}$ is satisfied only on certain curves.

        These curves may give **singular solutions** that are not included in $F(x,y) = C$ for any $C$.

        ### Explicit Solutions ###

        The implicit solution $F(x,y) = C$ can sometimes be solved explicitly for $y = y(x)$ or $x = x(y)$.

        Use the **implicit function theorem** to determine when this is possible.

related_topics:
  - slug: "calculus-partial-derivatives"
    title: "Partial Derivatives"
    description: "Required for exactness test"
  - slug: "calculus-integration"
    title: "Integration Techniques"
    description: "Used to find potential function"
  - slug: "ode-first_order-linear"
    title: "Linear First-Order ODEs"
    description: "Some exact equations are also linear"

references:
  - title: "Elementary Differential Equations"
    author: "William E. Boyce and Richard C. DiPrima"
    year: 2017
    publisher: "Wiley"
  - title: "Differential Equations with Applications and Historical Notes"
    author: "George F. Simmons"
    year: 2016
    publisher: "CRC Press"
  - title: "A First Course in Differential Equations"
    author: "J. David Logan"
    year: 2015
    publisher: "Springer"
