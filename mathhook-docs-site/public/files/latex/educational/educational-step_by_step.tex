\documentclass[11pt,a4paper]{article}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{hyperref}

\lstset{
    language=Python,
    basicstyle=\ttfamily\small,
    keywordstyle=\color{blue},
    commentstyle=\color{gray},
    stringstyle=\color{red},
    showstringspaces=false,
    breaklines=true,
    frame=single,
    numbers=left,
    numberstyle=\tiny\color{gray}
}

\title{ Step-by-Step Explanations }
\author{MathHook CAS}
\date{\today}

\begin{document}

\maketitle

\begin{abstract}
Educational explanations transform mathematical operations from black boxes into transparent learning experiences. The step-by-step system generates detailed walkthroughs showing exactly how MathHook arrives at solutions.

\end{abstract}




\section{Introduction}

# Step-by-Step Explanations

> üìç **Navigation:** [Educational API](./api.md) | [Message Registry](./messages.md) | [Operations](../operations/simplification.md)

Educational explanations transform mathematical operations from black boxes into transparent learning experiences. The step-by-step system generates detailed walkthroughs showing exactly how MathHook arrives at solutions.

## What Are Step-by-Step Explanations?

Step-by-step explanations provide detailed walkthroughs of mathematical operations, breaking down complex procedures into digestible steps. Each step includes:

- **Human-readable description** - Natural language explanation
- **Mathematical notation** - LaTeX and symbolic expressions
- **Rule applied** - The mathematical principle used
- **Current state** - Expression at this stage of solving

**Learning Journey:** This is your entry point for understanding MathHook's educational features. Once you master basic explanations, explore [message customization](./messages.md) and [programmatic integration](./api.md).

## Core Architecture

### StepByStepExplanation Structure

The core explanation type contains the complete journey from problem to solution:

```rust
pub struct StepByStepExplanation {
    pub initial_expression: Expression,
    pub final_expression: Expression,
    pub steps: Vec<Step>,
    pub total_steps: usize,
    pub rules_used: Vec<String>,
}
```

**Mathematical Formula for Steps:**

Each transformation follows the pattern:

$$
\text{Expression}_i \xrightarrow{\text{rule}} \text{Expression}_{i+1}
$$

Where the complete journey is:

$$
E_0 \xrightarrow{r_1} E_1 \xrightarrow{r_2} E_2 \xrightarrow{r_3} \cdots \xrightarrow{r_n} E_n
$$

### Step Structure

Each individual step captures one transformation:

```rust
pub struct Step {
    pub title: String,              // Brief step title
    pub description: String,        // Detailed explanation
    pub expression: Expression,     // Result after this step
    pub rule_applied: String,       // Mathematical rule name
    pub latex: Option<String>,      // LaTeX representation
}
```

### EnhancedStep: Dual-Format System

Enhanced steps provide both human and machine-consumable content:

```rust
pub struct EnhancedStep {
    pub step_id: String,
    pub title: String,
    pub human_message: String,      // Student-friendly text
    pub api_data: StepApiData,      // Machine-readable data
    pub message_key: MessageKey,    // Lookup for customization
    pub math_context: MathContext,  // Variables, progress, state
    pub presentation: PresentationHints,
}
```

**Design Philosophy:** Human messages teach students; API data enables external applications (LMS, mobile apps, assessment tools).





\section{Examples}


\subsection{ Simple Simplification Explanation }

Generate and display step-by-step simplification

\begin{lstlisting}
x = symbol('x')
expr = expr_parse('2*x + 3*x + 5')

# Generate step-by-step explanation
explanation = expr.explain_simplification()

# Display for students
print(f"Simplifying: {explanation.initial_expression}")
for i, step in enumerate(explanation.steps):
    print(f"\nStep {i + 1}: {step.title}")
    print(f"  {step.description}")
    print(f"  Result: {step.expression}")
    print(f"  Rule: {step.rule_applied}")
print(f"\nFinal answer: {explanation.final_expression}")

\end{lstlisting}




\subsection{ Expansion Explanation }

Show polynomial expansion with educational context

\begin{lstlisting}
x = symbol('x')
expr = expr_parse('(x + 1) * (x - 1)')

explanation = expr.explain_expansion()

# Check if expansion occurred
if explanation.total_steps > 0:
    print(f"Expansion required {explanation.total_steps} steps")
    print(f"Rules used: {explanation.rules_used}")
else:
    print("Already in expanded form")

\end{lstlisting}




\subsection{ Enhanced Steps with API Data }

Create enhanced steps for external application integration

\begin{lstlisting}
inputs = {
    "coefficient": "2",
    "variable": "x"
}

outputs = {
    "solution": "x = 3"
}

step = EnhancedStepBuilder("step_1") \
    .with_human_message(
        "Isolate Variable",
        "Divide both sides by the coefficient to isolate x"
    ) \
    .with_api_data("linear_equation", "isolation", "divide_coefficient") \
    .with_input("coefficient", "2") \
    .with_output("solution", "x = 3") \
    .with_math_context("2x = 6", "x", 0.75) \
    .with_message_key("linear_equation", "isolation", 0) \
    .build()

\end{lstlisting}




\subsection{ JSON Export for External Applications }

Export structured educational data for LMS integration

\begin{lstlisting}
# Export structured data for LMS integration
json_data = explanation.to_json()
# Send to learning management system, mobile app, etc.

\end{lstlisting}







\end{document}
