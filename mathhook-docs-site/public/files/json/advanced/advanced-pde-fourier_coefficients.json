{
  "topic": "advanced.pde.fourier_coefficients",
  "title": "Fourier Coefficients: Why They're Symbolic",
  "description": "Explanation of why Fourier coefficients in PDE solutions are returned as symbolic\nexpressions rather than numerical values. Covers the orthogonality principle,\nsymbolic integration requirements, and workarounds for computing coefficients manually.\n",
  "mathematical_definition": "For any PDE solution via separation of variables:\n$$u(x,t) = \\sum_{n=1}^{\\infty} A_n X_n(x) T_n(t)$$\n\nCoefficients from initial conditions:\n$$u(x,0) = f(x) = \\sum_{n=1}^{\\infty} A_n X_n(x)$$\n\n**Orthogonality** gives:\n$$A_n = \\frac{\\langle f, X_n \\rangle}{\\langle X_n, X_n \\rangle} = \\frac{\\int_0^L f(x) X_n(x) \\, dx}{\\int_0^L X_n^2(x) \\, dx}$$\n\n**Heat Equation (Dirichlet BCs):**\n$$X_n(x) = \\sin\\left(\\frac{n\\pi x}{L}\\right)$$\n\n$$A_n = \\frac{2}{L} \\int_0^L f(x) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx$$\n\n**Constant Initial Condition** ($f(x) = c$):\n$$A_n = \\frac{2c}{n\\pi} [1 - (-1)^n] = \\begin{cases}\n\\frac{4c}{n\\pi} & n \\text{ odd} \\\\\n0 & n \\text{ even}\n\\end{cases}$$\n",
  "code_refs": {
    "rust": "mathhook_core::pde::fourier::coefficients",
    "python": "mathhook.pde.fourier.coefficients",
    "nodejs": "mathhook.pde.fourier.coefficients"
  },
  "examples": [
    {
      "title": "Manual Coefficient Computation for Constant Initial Condition",
      "explanation": "Computing Fourier coefficients manually for heat equation with constant initial temperature",
      "code": {
        "rust": "use mathhook_core::pde::standard::heat::HeatEquationSolver;\nuse mathhook_core::{symbol, expr};\n\n// Setup PDE, BCs, IC...\nlet result = solver.solve_heat_equation_1d(&pde, &alpha, &bcs, &ic)?;\n\n// Coefficients are symbolic\nprintln!(\"Symbolic: {:?}\", result.coefficients);  // [A_1, A_2, A_3, ...]\n\n// Manually compute for f(x) = 100 (constant)\nlet mut numerical_coeffs = Vec::new();\nfor n in 1..=10 {\n    let a_n = if n % 2 == 1 {\n        // Odd n: A_n = 400/(nπ)\n        expr!(400.0 / ((n as f64) * std::f64::consts::PI))\n    } else {\n        // Even n: A_n = 0\n        expr!(0)\n    };\n    numerical_coeffs.push(a_n);\n}\n",
        "python": "from mathhook.pde.heat import HeatEquationSolver\nfrom mathhook import symbol, expr\nimport math\n\n# Setup PDE, BCs, IC...\nresult = solver.solve_heat_equation_1d(pde, alpha, bcs, ic)\n\n# Coefficients are symbolic\nprint(\"Symbolic:\", result.coefficients)  # [A_1, A_2, A_3, ...]\n\n# Manually compute for f(x) = 100 (constant)\nnumerical_coeffs = []\nfor n in range(1, 11):\n    if n % 2 == 1:\n        # Odd n: A_n = 400/(nπ)\n        a_n = expr(400.0 / (n * math.pi))\n    else:\n        # Even n: A_n = 0\n        a_n = expr(0)\n    numerical_coeffs.append(a_n)\n",
        "nodejs": "const { HeatEquationSolver } = require('mathhook/pde/heat');\nconst { symbol, expr } = require('mathhook');\n\n// Setup PDE, BCs, IC...\nconst result = solver.solveHeatEquation1d(pde, alpha, bcs, ic);\n\n// Coefficients are symbolic\nconsole.log(\"Symbolic:\", result.coefficients);  // [A_1, A_2, A_3, ...]\n\n// Manually compute for f(x) = 100 (constant)\nconst numericalCoeffs = [];\nfor (let n = 1; n <= 10; n++) {\n    let aN;\n    if (n % 2 === 1) {\n        // Odd n: A_n = 400/(nπ)\n        aN = expr(400.0 / (n * Math.PI));\n    } else {\n        // Even n: A_n = 0\n        aN = expr(0);\n    }\n    numericalCoeffs.push(aN);\n}\n"
      }
    }
  ],
  "article": {
    "content": "# Fourier Coefficients: Why They're Symbolic\n\n## The Coefficient Problem\n\nAll PDE solutions via separation of variables involve **Fourier series coefficients** that must be computed from initial/boundary conditions.\n\n### General Form\n\nFor any PDE solution:\n\n$$u(x,t) = \\sum_{n=1}^{\\infty} A_n X_n(x) T_n(t)$$\n\nThe coefficients $A_n$ come from matching initial conditions:\n\n$$u(x,0) = f(x) = \\sum_{n=1}^{\\infty} A_n X_n(x)$$\n\n**Orthogonality** of eigenfunctions $X_n(x)$ gives:\n\n$$A_n = \\frac{\\langle f, X_n \\rangle}{\\langle X_n, X_n \\rangle} = \\frac{\\int_0^L f(x) X_n(x) \\, dx}{\\int_0^L X_n^2(x) \\, dx}$$\n\n**This requires symbolic integration**.\n\n## Heat Equation Example\n\nFor heat equation with Dirichlet BCs on $[0,L]$:\n\n$$X_n(x) = \\sin\\left(\\frac{n\\pi x}{L}\\right)$$\n\nOrthogonality:\n\n$$\\int_0^L \\sin\\left(\\frac{n\\pi x}{L}\\right) \\sin\\left(\\frac{m\\pi x}{L}\\right) dx = \\begin{cases}\nL/2 & n = m \\\\\n0 & n \\neq m\n\\end{cases}$$\n\nFourier coefficients:\n\n$$A_n = \\frac{2}{L} \\int_0^L f(x) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx$$\n\n**Requires symbolic integration** of $f(x) \\sin(n\\pi x/L)$.\n\n### Simple Case: Constant Initial Condition\n\n$$f(x) = c \\quad \\text{(constant)}$$\n\n$$A_n = \\frac{2c}{L} \\int_0^L \\sin\\left(\\frac{n\\pi x}{L}\\right) dx = \\frac{2c}{L} \\left[-\\frac{L}{n\\pi} \\cos\\left(\\frac{n\\pi x}{L}\\right)\\right]_0^L$$\n\n$$= \\frac{2c}{n\\pi} [1 - \\cos(n\\pi)] = \\frac{2c}{n\\pi} [1 - (-1)^n]$$\n\n$$= \\begin{cases}\n\\frac{4c}{n\\pi} & n \\text{ odd} \\\\\n0 & n \\text{ even}\n\\end{cases}$$\n\n**MathHook can compute this** (Phase 2) with symbolic integration.\n\n### Complex Case: Arbitrary Function\n\n$$f(x) = x(L-x) \\quad \\text{(parabola)}$$\n\n$$A_n = \\frac{2}{L} \\int_0^L x(L-x) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx$$\n\n**Requires integration by parts twice**:\n\n$$= \\frac{2}{L} \\left[\\frac{4L^3}{n^3\\pi^3}[1 - (-1)^n]\\right] = \\frac{8L^2}{n^3\\pi^3}[1 - (-1)^n]$$\n\n**MathHook needs symbolic integration** for this.\n\n## Why MathHook Returns Symbolic Coefficients\n\n### Current Implementation\n\nMathHook solvers return:\n\n```rust\npub struct HeatSolution {\n    pub solution: Expression,     // Σ A_n sin(λₙx) exp(-λₙαt)\n    pub eigenvalues: Vec<Expression>,  // [λ₁, λ₂, λ₃, ...] ✅ COMPUTED\n    pub coefficients: Vec<Expression>, // [A_1, A_2, A_3, ...] ⚠️ SYMBOLIC\n}\n```\n\nThe `coefficients` are **symbolic symbols** $A_1, A_2, A_3, \\ldots$ (not numerical values).\n\n**Why?**\n\nComputing numerical $A_n$ requires:\n\n$$A_n = \\frac{2}{L} \\int_0^L f(x) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx$$\n\nThis is **symbolic integration** of a **user-provided function** $f(x)$.\n\n**MathHook's integration module** (Phase 1) focuses on:\n- Standard integrals ($\\int x^n dx$, $\\int \\sin(x) dx$, etc.)\n- Integration by substitution\n- Integration by parts\n\n**NOT YET IMPLEMENTED**:\n- Definite integral evaluation with symbolic limits\n- Fourier sine/cosine integral tables\n- Automated integration strategy selection\n\n### Phase 2 Roadmap\n\n**Goal**: Automatically compute Fourier coefficients for common initial conditions.\n\n**Requirements**:\n\n1. **Symbolic definite integration**\n2. **Fourier integral table**:\n   - $\\int_0^L 1 \\cdot \\sin(n\\pi x/L) dx$\n   - $\\int_0^L x \\cdot \\sin(n\\pi x/L) dx$\n   - $\\int_0^L x^2 \\cdot \\sin(n\\pi x/L) dx$\n   - $\\int_0^L e^{ax} \\cdot \\sin(n\\pi x/L) dx$\n\n3. **Pattern matching** for common forms:\n   - Polynomial × trig\n   - Exponential × trig\n   - Piecewise functions\n\n## Validation: SymPy Also Returns Symbolic\n\n**Important**: SymPy's `pdsolve()` **ALSO** returns symbolic coefficients.\n\n**Why?** SymPy separates:\n1. Solving PDE → symbolic solution structure\n2. Matching ICs → separate `fourier_series()` function\n\nMathHook follows the same philosophy.\n\n## Examples: Computing Coefficients\n\n### Heat Equation: Constant Initial Temp\n\n**Initial condition**: $u(x,0) = T_0$\n\n**Analytical**:\n\n$$A_n = \\frac{2T_0}{L} \\int_0^L \\sin\\left(\\frac{n\\pi x}{L}\\right) dx = \\frac{2T_0}{n\\pi}[1 - (-1)^n]$$\n\n**Numerical** (for $T_0 = 100$, $L = 1$):\n- $A_1 = \\frac{200}{\\pi} \\approx 63.66$\n- $A_2 = 0$\n- $A_3 = \\frac{200}{3\\pi} \\approx 21.22$\n- $A_4 = 0$\n- $A_5 = \\frac{200}{5\\pi} \\approx 12.73$\n\n### Wave Equation: Triangular Pluck\n\n**Initial position**: Triangular (plucked at center)\n\n**Analytical**:\n\n$$A_n = \\frac{8h}{n^2\\pi^2} \\sin\\left(\\frac{n\\pi}{2}\\right)$$\n\n**Numerical** (for $h = 0.005$ m):\n- $A_1 = \\frac{8 \\times 0.005}{\\pi^2} \\approx 0.00405$ m\n- $A_2 = 0$ (sin(π) = 0)\n- $A_3 = -\\frac{8 \\times 0.005}{9\\pi^2} \\approx -0.00045$ m\n- $A_4 = 0$\n\n### Laplace Equation: Fixed Top Edge\n\n**Boundary condition**: $u(x,b) = V_0$\n\n**Analytical**:\n\n$$C_n = \\frac{2V_0}{n\\pi \\sinh(n\\pi b/a)} [1 - (-1)^n]$$\n\n**Numerical** (for $V_0 = 100$, $a=0.1$, $b=0.05$):\n- $C_1 = \\frac{200}{\\pi \\sinh(\\pi/2)} \\approx 27.67$\n- $C_2 = 0$\n- $C_3 = \\frac{200}{3\\pi \\sinh(3\\pi/2)} \\approx 0.83$\n"
  },
  "use_cases": [
    "Understanding why PDE solutions have symbolic coefficients",
    "Manually computing Fourier coefficients for simple initial conditions",
    "Educational demonstrations of orthogonality principle",
    "Comparison with SymPy's approach to Fourier series",
    "Planning Phase 2 symbolic integration features"
  ],
  "related_topics": [
    "advanced.pde.boundary_conditions",
    "advanced.pde.classification",
    "calculus.integration",
    "calculus.heat_equation",
    "calculus.wave_equation"
  ],
  "performance": {
    "complexity": "O(n)",
    "typical_time": "Variable (depends on integration complexity)"
  },
  "metadata": {
    "schema_version": "1.0"
  }
}