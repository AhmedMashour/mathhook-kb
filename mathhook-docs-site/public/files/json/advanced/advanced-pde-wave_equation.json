{
  "topic": "advanced.pde.wave_equation",
  "title": "Wave Equation Solver",
  "description": "The wave equation governs oscillatory phenomena and wave propagation in physical systems.\nSolves hyperbolic PDEs with boundary conditions and two initial conditions (position and velocity).\n",
  "mathematical_definition": "$$\\frac{\\partial^2 u}{\\partial t^2} = c^2 \\nabla^2 u$$\n\nwhere:\n- $u(x,t)$ is displacement at position $x$ and time $t$\n- $c$ is wave speed (m/s)\n- $\\nabla^2 u = \\frac{\\partial^2 u}{\\partial x^2}$ (1D)\n\n**Newton's Second Law** for string element:\n$$\\rho \\frac{\\partial^2 u}{\\partial t^2} = T \\frac{\\partial^2 u}{\\partial x^2}$$\n\n**Wave speed**: $c = \\sqrt{T/\\rho}$ where $\\rho$ = linear mass density, $T$ = tension\n",
  "code_refs": {
    "rust": "mathhook_core::pde::WaveEquationSolver",
    "python": "mathhook.pde.wave_equation_solver",
    "nodejs": "mathhook.pde.waveEquationSolver"
  },
  "examples": [
    {
      "title": "Vibrating Guitar String",
      "explanation": "A 0.65m guitar string plucked at center with 5mm displacement, demonstrating wave propagation and standing waves.",
      "code": {
        "rust": "use mathhook::prelude::*;\n\n// Variables\nlet u = symbol!(u);\nlet x = symbol!(x);\nlet t = symbol!(t);\n\n// PDE\nlet equation = expr!(u);\nlet pde = Pde::new(equation, u, vec![x.clone(), t.clone()]);\n\n// Wave speed\nlet c = expr!(442);  // m/s for steel E string\n\n// Boundary conditions\nlet bc1 = BoundaryCondition::dirichlet(\n    expr!(0),\n    BoundaryLocation::Simple {\n        variable: x.clone(),\n        value: expr!(0),\n    },\n);\nlet bc2 = BoundaryCondition::dirichlet(\n    expr!(0),\n    BoundaryLocation::Simple {\n        variable: x,\n        value: expr!(0.65),  // L = 0.65 m\n    },\n);\n\n// Initial conditions\nlet ic_position = InitialCondition::value(\n    // Triangular function (symbolic - not yet computable)\n    expr!(0.005)  // Placeholder for triangular shape\n);\nlet ic_velocity = InitialCondition::derivative(expr!(0));  // Released from rest\n\n// Solve\nlet solver = WaveEquationSolver::new();\nlet result = solver.solve_wave_equation_1d(\n    &pde,\n    &c,\n    &[bc1, bc2],\n    &ic_position,\n    &ic_velocity\n)?;\n\n// What you get:\nprintln!(\"Solution: {}\", result.solution);\n// u(x,t) = [A_1*cos(ω₁*t) + B_1*sin(ω₁*t)]*sin(π*x/L) + ...\n\nprintln!(\"Eigenvalues: {:?}\", result.eigenvalues);\n// [λ₁, λ₂, λ₃, ...] where λₙ = (nπ/L)²\n\nprintln!(\"Position coefficients (A_n): {:?}\", result.position_coefficients);\nprintln!(\"Velocity coefficients (B_n): {:?}\", result.velocity_coefficients);\n",
        "python": "from mathhook import symbol, expr, Pde, BoundaryCondition, BoundaryLocation, InitialCondition, WaveEquationSolver\n\n# Variables\nu = symbol('u')\nx = symbol('x')\nt = symbol('t')\n\n# PDE\nequation = expr(u)\npde = Pde(equation, u, [x, t])\n\n# Wave speed\nc = expr(442)\n\n# Boundary conditions\nbc1 = BoundaryCondition.dirichlet(\n    expr(0),\n    BoundaryLocation.simple(variable=x, value=expr(0))\n)\nbc2 = BoundaryCondition.dirichlet(\n    expr(0),\n    BoundaryLocation.simple(variable=x, value=expr(0.65))\n)\n\n# Initial conditions\nic_position = InitialCondition.value(expr(0.005))\nic_velocity = InitialCondition.derivative(expr(0))\n\n# Solve\nsolver = WaveEquationSolver()\nresult = solver.solve_wave_equation_1d(pde, c, [bc1, bc2], ic_position, ic_velocity)\n\nprint(f\"Solution: {result.solution}\")\nprint(f\"Eigenvalues: {result.eigenvalues}\")\n",
        "nodejs": "const { symbol, expr, Pde, BoundaryCondition, BoundaryLocation, InitialCondition, WaveEquationSolver } = require('mathhook');\n\n// Variables\nconst u = symbol('u');\nconst x = symbol('x');\nconst t = symbol('t');\n\n// PDE\nconst equation = expr(u);\nconst pde = new Pde(equation, u, [x, t]);\n\n// Wave speed\nconst c = expr(442);\n\n// Boundary conditions\nconst bc1 = BoundaryCondition.dirichlet(\n    expr(0),\n    BoundaryLocation.simple({ variable: x, value: expr(0) })\n);\nconst bc2 = BoundaryCondition.dirichlet(\n    expr(0),\n    BoundaryLocation.simple({ variable: x, value: expr(0.65) })\n);\n\n// Initial conditions\nconst icPosition = InitialCondition.value(expr(0.005));\nconst icVelocity = InitialCondition.derivative(expr(0));\n\n// Solve\nconst solver = new WaveEquationSolver();\nconst result = solver.solveWaveEquation1d(pde, c, [bc1, bc2], icPosition, icVelocity);\n\nconsole.log(`Solution: ${result.solution}`);\nconsole.log(`Eigenvalues: ${result.eigenvalues}`);\n"
      }
    }
  ],
  "article": {
    "content": "# Wave Equation Solver\n\n## Mathematical Model\n\nThe **wave equation** governs oscillatory phenomena and wave propagation:\n\n$$\\frac{\\partial^2 u}{\\partial t^2} = c^2 \\nabla^2 u$$\n\nwhere:\n- $u(x,t)$ is displacement at position $x$ and time $t$\n- $c$ is wave speed (m/s)\n- $\\nabla^2 u = \\frac{\\partial^2 u}{\\partial x^2}$ (1D)\n\n## Physical Interpretation\n\n**Newton's Second Law** applied to small element of string/membrane:\n\n$$\\rho \\frac{\\partial^2 u}{\\partial t^2} = T \\frac{\\partial^2 u}{\\partial x^2}$$\n\nwhere $\\rho$ = linear mass density, $T$ = tension.\n\n**Wave speed**: $c = \\sqrt{T/\\rho}$\n\n**Key property**: Waves propagate at **finite speed** $c$ (unlike heat equation's infinite speed).\n\n## Real-World Example: Vibrating Guitar String\n\n### Problem Setup\n\nA guitar string of length $L = 0.65$ m (standard scale length) is plucked at the center, displaced $5$ mm, and released from rest.\n\n**Material** (steel E string):\n- Tension: $T = 73.4$ N\n- Linear density: $\\rho = 3.75 \\times 10^{-4}$ kg/m\n- Wave speed: $c = \\sqrt{T/\\rho} = \\sqrt{73.4 / 3.75 \\times 10^{-4}} \\approx 442$ m/s\n\n### Mathematical Formulation\n\n**PDE**:\n$$\\frac{\\partial^2 u}{\\partial t^2} = c^2 \\frac{\\partial^2 u}{\\partial x^2}, \\quad 0 < x < L, \\quad t > 0$$\n\n**Boundary Conditions** (fixed ends):\n$$u(0, t) = 0, \\quad u(L, t) = 0$$\n\n**Initial Position** (triangular pluck at center):\n$$u(x, 0) = \\begin{cases}\n\\frac{2h}{L}x & 0 \\leq x \\leq L/2 \\\\\n\\frac{2h}{L}(L-x) & L/2 < x \\leq L\n\\end{cases}$$\n\nwhere $h = 0.005$ m (5 mm displacement).\n\n**Initial Velocity** (released from rest):\n$$\\frac{\\partial u}{\\partial t}(x, 0) = 0$$\n\n### Analytical Solution\n\n**General solution**:\n\n$$u(x,t) = \\sum_{n=1}^{\\infty} \\left[A_n \\cos(\\omega_n t) + B_n \\sin(\\omega_n t)\\right] \\sin\\left(\\frac{n\\pi x}{L}\\right)$$\n\nwhere:\n- **Eigenvalues**: $\\lambda_n = (n\\pi/L)^2$\n- **Angular frequencies**: $\\omega_n = c\\lambda_n^{1/2} = \\frac{n\\pi c}{L}$\n- **Physical frequencies**: $f_n = \\frac{\\omega_n}{2\\pi} = \\frac{nc}{2L}$\n\n**Fourier coefficients from initial position**:\n\n$$A_n = \\frac{2}{L} \\int_0^L u(x,0) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx$$\n\nFor triangular pluck:\n\n$$A_n = \\frac{8h}{n^2 \\pi^2} \\sin\\left(\\frac{n\\pi}{2}\\right) = \\begin{cases}\n\\frac{8h}{n^2\\pi^2}(-1)^{(n-1)/2} & \\text{if } n \\text{ odd} \\\\\n0 & \\text{if } n \\text{ even}\n\\end{cases}$$\n\n**From initial velocity** (released from rest: $\\partial u/\\partial t = 0$):\n\n$$B_n = 0 \\quad \\text{for all } n$$\n\n**Final solution**:\n\n$$u(x,t) = \\frac{8h}{\\pi^2} \\sum_{k=0}^{\\infty} \\frac{(-1)^k}{(2k+1)^2} \\sin\\left(\\frac{(2k+1)\\pi x}{L}\\right) \\cos\\left(\\frac{(2k+1)\\pi c t}{L}\\right)$$\n\n## Musical Harmonics\n\n### Fundamental Frequency (n=1)\n\n$$f_1 = \\frac{c}{2L} = \\frac{442}{2 \\times 0.65} \\approx 340 \\, \\text{Hz}$$\n\nThis is close to **E4 note** (329.63 Hz) - the open E string frequency.\n\n### Overtones (n=2, 3, 4, ...)\n\n$$f_n = n f_1$$\n\n- $f_2 = 680$ Hz (octave)\n- $f_3 = 1020$ Hz (octave + fifth)\n- $f_4 = 1360$ Hz (two octaves)\n\n**Timbre**: Combination of harmonics determines sound quality. Triangular pluck emphasizes odd harmonics.\n\n## Standing Waves\n\n**Physical interpretation**: Superposition of left-traveling and right-traveling waves.\n\n**D'Alembert solution**:\n\n$$u(x,t) = \\frac{1}{2}[f(x-ct) + f(x+ct)]$$\n\nwhere $f(x)$ is the initial shape extended periodically.\n\n**Standing wave form**: Separation of variables gives standing waves (nodes don't move).\n\n**Nodes**: Points where $u(x,t) = 0$ for all $t$:\n\n$$\\sin\\left(\\frac{n\\pi x}{L}\\right) = 0 \\implies x = \\frac{kL}{n}, \\quad k = 0, 1, \\ldots, n$$\n\nMode $n$ has $n+1$ nodes (including endpoints).\n\n## Energy Conservation\n\n**Total energy** (kinetic + potential):\n\n$$E(t) = \\frac{1}{2} \\int_0^L \\left[\\rho \\left(\\frac{\\partial u}{\\partial t}\\right)^2 + T \\left(\\frac{\\partial u}{\\partial x}\\right)^2 \\right] dx$$\n\n**Theorem**: For wave equation with fixed BCs, $E(t) = E(0)$ (constant).\n\n**Proof sketch**: $\\frac{dE}{dt} = 0$ using PDE and integration by parts.\n\n**Physical meaning**: No energy dissipation (ideal string). Real strings have damping → telegraph equation.\n\n## Limitations\n\n⚠️ **Symbolic coefficients only** (same as heat equation)\n\n⚠️ **Damped waves NOT supported**: Telegraph equation $u_{tt} + 2\\alpha u_t = c^2 u_{xx}$ requires different solver.\n\n⚠️ **Forcing terms NOT supported**: $u_{tt} = c^2 u_{xx} + F(x,t)$ requires inhomogeneous solution methods.\n"
  },
  "use_cases": [
    "Acoustics: Musical instrument string vibrations",
    "Physics: Wave propagation in elastic media",
    "Engineering: Structural vibration analysis",
    "Signal Processing: Harmonic analysis and frequency decomposition"
  ],
  "related_topics": [
    "advanced.pde.heat_equation",
    "advanced.pde.laplace_equation",
    "advanced.pde.separation_of_variables",
    "advanced.pde.examples"
  ],
  "performance": {
    "complexity": "O(n) for n Fourier modes",
    "typical_time": "1-5ms for symbolic solution structure"
  },
  "outputs": {
    "jupyter": {
      "include_interactive_plots": true,
      "include_performance_section": false
    },
    "mdbook": {
      "include_mathematical_proof": true,
      "include_implementation_details": false,
      "runnable_code": true
    },
    "vue_site": {
      "include_live_demo": true,
      "seo_keywords": [
        "wave equation",
        "vibrating string",
        "PDE solver",
        "harmonics"
      ]
    },
    "api_docs": {
      "include_playground": true,
      "show_all_languages": true
    },
    "llm_rag": {
      "chunk_strategy": "by_section",
      "max_chunk_size": 1024,
      "embedding_priority": "medium"
    }
  },
  "metadata": {
    "schema_version": "1.0"
  }
}