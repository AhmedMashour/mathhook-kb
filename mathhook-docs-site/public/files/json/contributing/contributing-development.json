{
  "topic": "contributing.development",
  "title": "Development Guide",
  "description": "Setup and workflow for MathHook development.\n",
  "article": {
    "content": "# Development Guide\n\nSetup and workflow for MathHook development.\n\n## Prerequisites\n\n- **Rust 1.70+** (stable)\n- **Git**\n- **Python 3.8+** with SymPy (for validation)\n\n## Quick Start\n\n### Clone and Build\n\n```bash\ngit clone https://github.com/AhmedMashour/mathhook.git\ncd mathhook\ncargo build --release\n```\n\n### Run Tests\n\n```bash\n# All tests (recommended)\ngtimeout 600s cargo test --no-fail-fast\n\n# Doctests only\ngtimeout 600s cargo test --no-fail-fast --doc\n\n# Specific crate\ncargo test -p mathhook-core\n```\n\n### Run Benchmarks\n\n```bash\n./scripts/bench.sh run       # Full benchmarks\n./scripts/bench.sh quick     # Quick run\n./scripts/bench.sh save pre  # Save baseline before changes\n./scripts/bench.sh compare pre  # Compare after changes\n```\n\n## Project Structure\n\n```\nmathhook/\n├── crates/\n│   ├── mathhook-core/       # Core mathematical engine\n│   ├── mathhook-macros/     # Procedural macros (expr!, symbol!, etc.)\n│   ├── mathhook/            # High-level user API\n│   ├── mathhook-python/     # Python bindings (PyO3)\n│   ├── mathhook-node/       # Node.js bindings (NAPI)\n│   └── mathhook-benchmarks/ # Performance benchmarks\n├── docs/                    # mdbook documentation\n├── scripts/                 # Build and validation scripts\n└── CLAUDE.md                # Development rules and standards\n```\n\n### Crate Responsibilities\n\n| Crate | Purpose |\n|-------|---------|\n| `mathhook-core` | Expression types, parser, operations, functions |\n| `mathhook-macros` | `symbol!`, `symbols!`, `function!`, `expr!` macros |\n| `mathhook` | Re-exports, prelude, user-friendly API |\n| `mathhook-python` | PyO3 bindings for Python |\n| `mathhook-node` | NAPI bindings for Node.js |\n\n## Development Workflow\n\n### Before Starting\n\n```bash\ngit status                    # Check clean state\ngit checkout -b feature/name  # Create feature branch\n```\n\n### Development Cycle\n\n1. **Read [CONTRIBUTING.md](../../../CONTRIBUTING.md)** - Understand rules and priorities\n2. **Plan the change** - Consider mathematical correctness first\n3. **Implement** - Use macros, follow style guide\n4. **Test** - Run `cargo test`, add new tests\n5. **Validate** - Run `./scripts/validate.sh` for math operations\n6. **Format** - Run `cargo fmt`\n7. **Lint** - Run `cargo clippy -- -D warnings`\n\n### Before Committing\n\n```bash\ncargo fmt                      # Format code\ncargo clippy -- -D warnings    # Zero warnings\ncargo test                     # All tests pass\n```\n\n## Key Commands\n\n| Task | Command |\n|------|---------|\n| Build | `cargo build --release` |\n| Test | `gtimeout 600s cargo test --no-fail-fast` |\n| Doctest | `gtimeout 600s cargo test --no-fail-fast --doc` |\n| Format | `cargo fmt` |\n| Lint | `cargo clippy -- -D warnings` |\n| Benchmark | `./scripts/bench.sh run` |\n| Validate Math | `./scripts/validate.sh` |\n| Build Docs | `cd docs && mdbook build` |\n| Serve Docs | `cd docs && mdbook serve --open` |\n\n## Documentation\n\n### mdbook\n\n```bash\ncd docs\nmdbook serve --open  # Preview at localhost:3000\nmdbook build         # Build static site\n```\n\n### Rust Docs\n\n```bash\ncargo doc --open     # Generate and view API docs\n```\n\n## Validation\n\n### SymPy Reference\n\nAlways verify mathematical operations against SymPy:\n\n```python\nfrom sympy import *\nx = Symbol('x')\nprint(simplify(sin(x)**2 + cos(x)**2))  # Should be 1\n```\n\n### Validation Scripts\n\n```bash\n./scripts/validate.sh           # All validations\n./scripts/validate.sh simplify  # Specific module\n./scripts/validate.sh ode       # ODE solver\n```\n\n## Performance\n\n### Benchmarking Workflow\n\n```bash\n# 1. Save baseline before changes\n./scripts/bench.sh save before-change\n\n# 2. Make your changes\n\n# 3. Compare performance\n./scripts/bench.sh compare before-change\n```\n\n### Size Constraints\n\n| Type | Maximum Size |\n|------|-------------|\n| `Expression` | 32 bytes |\n| `Number` | 16 bytes |\n| Source file | 500 lines |\n\n## Common Issues\n\n### Parser Regeneration\n\n```bash\n# If grammar changes\nlalrpop crates/mathhook-core/src/parser/grammar.lalrpop\n```\n\n### Macro Not Found\n\nEnsure `mathhook-macros` is in dependencies and macros are re-exported.\n\n### Test Timeout\n\nUse `gtimeout` prefix for long-running tests:\n```bash\ngtimeout 600s cargo test --no-fail-fast\n```\n\n## Getting Help\n\n1. **Read [CONTRIBUTING.md](../../../CONTRIBUTING.md)** - Contains all development rules\n2. **Check existing code** - Follow established patterns\n3. **Run tests** - They document expected behavior\n4. **Validate against SymPy** - For mathematical correctness\n"
  },
  "related_topics": [
    "contributing.testing",
    "contributing.style",
    "contributing.documentation",
    "contributing.correctness",
    "contributing.architecture-reference"
  ],
  "metadata": {
    "schema_version": "1.0"
  }
}