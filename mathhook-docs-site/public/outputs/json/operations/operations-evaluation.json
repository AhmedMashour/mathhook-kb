{
  "topic": "operations.evaluation",
  "title": "Expression Evaluation",
  "description": "MathHook provides two fundamental operations for working with expressions:\n\n1. **Evaluation** - Compute numerical values with domain checking\n2. **Simplification** - Algebraic reduction while staying symbolic\n\nUnderstanding when to use each operation is critical for correct mathematical computation.\n",
  "mathematical_definition": "**Function Evaluation:**\n$$f(a) = f(x)|_{x=a}$$\n\n**Evaluation with Context:**\nFor expression $f(x_1, \\ldots, x_n)$ and substitutions $\\{x_i \\mapsto v_i\\}$:\n$$\\text{evaluate}(f, \\{x_i \\mapsto v_i\\}) = f(v_1, \\ldots, v_n)$$\n\n**Domain Constraints:**\n- $\\sqrt{x}$ requires $x \\geq 0$ in $\\mathbb{R}$\n- $\\log(x)$ requires $x > 0$ (pole at 0)\n- $\\tan(x)$ has poles at $\\frac{\\pi}{2} + n\\pi$\n- $\\arcsin(x), \\arccos(x)$ require $|x| \\leq 1$ in $\\mathbb{R}$\n",
  "code_refs": {
    "rust": "mathhook_core::core::expression::eval_numeric::evaluate",
    "python": "mathhook.evaluate",
    "nodejs": "mathhook.evaluate"
  },
  "examples": [
    {
      "title": "Constants Evaluate to Numbers",
      "explanation": "Direct evaluation of constant expressions",
      "code": {
        "rust": "use mathhook::prelude::*;\n\nlet sum = expr!(2 + 3);\nassert_eq!(sum.evaluate().unwrap(), expr!(5));\n\n// Domain checking catches errors\nlet sqrt_neg = expr!(sqrt(-1));\nassert!(matches!(sqrt_neg.evaluate(), Err(MathError::DomainError { .. })));\n",
        "python": "from mathhook import expr\n\nsum_expr = expr('2 + 3')\nassert sum_expr.evaluate() == 5\n\n# Domain checking catches errors\nsqrt_neg = expr('sqrt(-1)')\ntry:\n    sqrt_neg.evaluate()\n    assert False, \"Should raise domain error\"\nexcept MathError:\n    pass\n",
        "nodejs": "const { expr } = require('mathhook');\n\nconst sum = expr('2 + 3');\nassert(sum.evaluate() === 5);\n\n// Domain checking catches errors\nconst sqrtNeg = expr('sqrt(-1)');\ntry {\n    sqrtNeg.evaluate();\n    throw new Error(\"Should raise domain error\");\n} catch (e) {\n    // Expected MathError\n}\n"
      }
    },
    {
      "title": "Evaluation with Context (Substitution)",
      "explanation": "Substitute variable values and evaluate",
      "code": {
        "rust": "use mathhook_core::core::expression::eval_numeric::EvalContext;\nuse mathhook::prelude::*;\nuse std::collections::HashMap;\n\nlet x = symbol!(x);\n\n// Substitute x = 3 and evaluate\nlet mut vars = HashMap::new();\nvars.insert(\"x\".to_string(), Expression::integer(3));\nlet ctx = EvalContext::numeric(vars);\n\nlet expr = Expression::pow(x.clone(), Expression::integer(2));\nassert_eq!(expr.evaluate_with_context(&ctx).unwrap(), Expression::integer(9));\n",
        "python": "from mathhook import symbol, Expression\n\nx = symbol('x')\nexpr = x ** 2\n\n# Substitute x = 3 and evaluate\nctx = {'x': 3}\nresult = expr.evaluate_with_context(ctx)\nassert result == 9\n",
        "nodejs": "const { symbol } = require('mathhook');\n\nconst x = symbol('x');\nconst expr = x.pow(2);\n\n// Substitute x = 3 and evaluate\nconst ctx = { x: 3 };\nconst result = expr.evaluateWithContext(ctx);\nassert(result === 9);\n"
      }
    },
    {
      "title": "Simplification Without Domain Checking",
      "explanation": "Simplify operates purely symbolically without domain validation",
      "code": {
        "rust": "use mathhook::prelude::*;\nuse mathhook_core::simplify::Simplify;\n\nlet x = symbol!(x);\n\n// Combine like terms\nlet sum = expr!(x + x);\nassert_eq!(sum.simplify(), expr!(2 * x));\n\n// Apply identities\nassert_eq!(expr!(x * 1).simplify(), expr!(x));\nassert_eq!(expr!(0 * x).simplify(), expr!(0));\n",
        "python": "from mathhook import symbol\n\nx = symbol('x')\n\n# Combine like terms\nsum_expr = x + x\nassert sum_expr.simplify() == 2 * x\n\n# Apply identities\nassert (x * 1).simplify() == x\nassert (0 * x).simplify() == 0\n",
        "nodejs": "const { symbol } = require('mathhook');\n\nconst x = symbol('x');\n\n// Combine like terms\nconst sumExpr = x.add(x);\nassert(sumExpr.simplify().equals(x.mul(2)));\n\n// Apply identities\nassert(x.mul(1).simplify().equals(x));\nassert(x.mul(0).simplify().equals(0));\n"
      }
    }
  ],
  "article": {
    "content": "## Quick Decision Guide\n\nNeed a numerical value?\n├─ YES → Use evaluate() or evaluate_with_context()\n│   ├─ With variables? → evaluate_with_context(context)\n│   └─ Constants only? → evaluate()\n│\n└─ NO → Need algebraic simplification?\n    ├─ YES → Use simplify()\n    └─ NO → Keep expression as-is\n\n## Key Differences\n\n| Operation | Purpose | Domain Checking | Substitution | Returns |\n|-----------|---------|-----------------|--------------|---------|\n| **evaluate()** | Numerical computation | ✅ Yes | ❌ No | Result<Expression, MathError> |\n| **evaluate_with_context()** | Substitution + computation | ✅ Yes | ✅ Yes | Result<Expression, MathError> |\n| **simplify()** | Algebraic reduction | ❌ No | ❌ No | Expression |\n\n## Domain Constraints Checked\n\n- sqrt(x): Requires x ≥ 0 in real domain\n- log(x): Requires x > 0 (pole at 0)\n- tan(x): Has poles at π/2 + nπ\n- arcsin(x), arccos(x): Require |x| ≤ 1 in real domain\n- Division by zero: Checked in x/y and x^(-n)\n\n## Evaluation Context Options\n\n```rust\npub struct EvalContext {\n    pub variables: HashMap<String, Expression>,  // Variable substitutions\n    pub precision: u32,                          // Numerical precision\n    pub simplify_first: bool,                    // Simplify before evaluation?\n    pub numeric: bool,                           // Perform numerical evaluation?\n}\n```\n"
  },
  "use_cases": [
    "Numerical computation: Get concrete values from expressions",
    "Domain validation: Ensure mathematical operations are valid",
    "Physics/Engineering: Evaluate formulas with specific parameters",
    "Algebraic simplification: Reduce expressions to canonical form"
  ],
  "related_topics": [
    "operations.substitution",
    "operations.simplification"
  ],
  "performance": {
    "complexity": "O(n) for expression tree size n"
  },
  "metadata": {
    "schema_version": "1.0",
    "last_updated": "2025-01-24T1730"
  }
}