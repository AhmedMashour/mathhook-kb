{
  "topic": "advanced.pde.separation_of_variables",
  "title": "Separation of Variables",
  "description": "Separation of Variables is the fundamental technique for solving linear second-order partial differential equations (PDEs) with boundary conditions.\nIt transforms the PDE into multiple ordinary differential equations (ODEs) that can be solved independently.\n",
  "mathematical_definition": "**Core Assumption**: For PDE with two independent variables $x$ and $t$:\n$$u(x,t) = X(x) \\cdot T(t)$$\n\nFor three variables (e.g., Laplace in 2D):\n$$u(x,y) = X(x) \\cdot Y(y)$$\n\n**The Separation Process**:\n1. Substitute product form into PDE\n2. Separate variables (all $x$-terms on one side, all $t$-terms on other)\n3. Both sides equal same constant (separation constant $\\lambda$)\n4. Solve resulting ODEs\n5. Apply boundary conditions to find eigenvalues\n6. Construct general solution as superposition\n",
  "code_refs": {
    "rust": "mathhook_core::pde::separation_of_variables",
    "python": "mathhook.pde.separation_of_variables",
    "nodejs": "mathhook.pde.separationOfVariables"
  },
  "examples": [
    {
      "title": "Heat Equation with Separation of Variables",
      "explanation": "Demonstrates separation of variables for 1D heat diffusion in a rod.",
      "code": {
        "rust": "use mathhook::prelude::*;\n\nlet registry = PDESolverRegistry::new();\nlet solution = registry.solve(&pde).unwrap();\n// Automatically uses separation of variables if applicable\n\n// The solver internally:\n// 1. Assumes u(x,t) = X(x)*T(t)\n// 2. Separates into spatial and temporal ODEs\n// 3. Applies BCs to find eigenvalues\n// 4. Constructs superposition solution\n",
        "python": "from mathhook import PDESolverRegistry\n\nregistry = PDESolverRegistry()\nsolution = registry.solve(pde)\n# Automatically uses separation of variables if applicable\n",
        "nodejs": "const { PDESolverRegistry } = require('mathhook');\n\nconst registry = new PDESolverRegistry();\nconst solution = registry.solve(pde);\n// Automatically uses separation of variables if applicable\n"
      }
    }
  ],
  "article": {
    "content": "# Separation of Variables\n\n**Separation of Variables** is the fundamental technique for solving linear second-order partial differential equations (PDEs) with boundary conditions. It transforms the PDE into multiple ordinary differential equations (ODEs) that can be solved independently.\n\n## Quick Overview\n\n**Applies to:** Linear second-order PDEs with separable boundary conditions\n**Equation types:** Heat equation, wave equation, Laplace equation\n**Key idea:** Assume solution is a product of functions, each depending on only one variable\n**MathHook implementation:** Used internally by Heat, Wave, and Laplace solvers\n\n## Mathematical Foundation\n\n### Core Assumption\n\nFor a PDE with two independent variables $x$ and $t$, assume:\n$$u(x,t) = X(x) \\cdot T(t)$$\n\nFor three variables (e.g., Laplace in 2D):\n$$u(x,y) = X(x) \\cdot Y(y)$$\n\n**Crucial requirement:** The PDE must be **linear** (otherwise product form doesn't work)\n\n### The Separation Process\n\n**Step 1:** Substitute product form into PDE\n\n**Step 2:** Separate variables (all $x$-terms on one side, all $t$-terms on other)\n\n**Step 3:** Both sides must equal same constant (the **separation constant** $\\lambda$)\n\n**Step 4:** Solve resulting ODEs\n\n**Step 5:** Apply boundary conditions to find eigenvalues\n\n**Step 6:** Construct general solution as superposition\n\n## Complete Examples\n\n### Example 1: Heat Equation (1D)\n\n**Problem:** Solve heat diffusion in a rod of length $L$\n\n**PDE:** $\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}$\n\n**Boundary conditions:** $u(0,t) = 0$, $u(L,t) = 0$ (fixed temperature at ends)\n\n**Initial condition:** $u(x,0) = f(x)$ (initial temperature distribution)\n\n**Solution Steps:**\n\n**1. Assume product solution:**\n$$u(x,t) = X(x) T(t)$$\n\n**2. Substitute into PDE:**\n$$X(x) T'(t) = \\alpha X''(x) T(t)$$\n\n**3. Separate variables:**\n$$\\frac{T'(t)}{\\alpha T(t)} = \\frac{X''(x)}{X(x)}$$\n\nLeft side depends only on $t$, right side only on $x$. Both must equal constant $-\\lambda$:\n\n**4. Get two ODEs:**\n- **Spatial ODE:** $X''(x) + \\lambda X(x) = 0$\n- **Temporal ODE:** $T'(t) + \\lambda \\alpha T(t) = 0$\n\n**5. Apply boundary conditions to spatial ODE:**\n\n$X(0) = 0$ and $X(L) = 0$ give eigenvalues:\n$$\\lambda_n = \\left(\\frac{n\\pi}{L}\\right)^2, \\quad n = 1, 2, 3, \\ldots$$\n\nEigenfunctions:\n$$X_n(x) = \\sin\\left(\\frac{n\\pi x}{L}\\right)$$\n\n**6. Solve temporal ODE:**\n$$T_n(t) = e^{-\\lambda_n \\alpha t}$$\n\n**7. General solution (superposition):**\n$$u(x,t) = \\sum_{n=1}^{\\infty} A_n \\sin\\left(\\frac{n\\pi x}{L}\\right) e^{-\\lambda_n \\alpha t}$$\n\n**8. Match initial condition:**\n$$u(x,0) = f(x) = \\sum_{n=1}^{\\infty} A_n \\sin\\left(\\frac{n\\pi x}{L}\\right)$$\n\nFourier coefficients:\n$$A_n = \\frac{2}{L} \\int_0^L f(x) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx$$\n\n### Example 2: Wave Equation (1D)\n\n**Problem:** Vibrating string of length $L$\n\n**PDE:** $\\frac{\\partial^2 u}{\\partial t^2} = c^2 \\frac{\\partial^2 u}{\\partial x^2}$\n\n**Boundary conditions:** $u(0,t) = 0$, $u(L,t) = 0$ (fixed ends)\n\n**Initial conditions:** $u(x,0) = f(x)$ (initial displacement), $\\frac{\\partial u}{\\partial t}(x,0) = g(x)$ (initial velocity)\n\n**Solution Steps:**\n\n**1. Assume:** $u(x,t) = X(x) T(t)$\n\n**2. Substitute and separate:**\n$$\\frac{T''(t)}{c^2 T(t)} = \\frac{X''(x)}{X(x)} = -\\lambda$$\n\n**3. Spatial ODE (same as heat equation):**\n$$X''(x) + \\lambda X(x) = 0$$\n\nEigenvalues: $\\lambda_n = (n\\pi/L)^2$\n\nEigenfunctions: $X_n(x) = \\sin(n\\pi x/L)$\n\n**4. Temporal ODE:**\n$$T''(t) + \\lambda c^2 T(t) = 0$$\n\nSolution (oscillatory):\n$$T_n(t) = A_n \\cos(\\omega_n t) + B_n \\sin(\\omega_n t)$$\n\nwhere $\\omega_n = c\\sqrt{\\lambda_n} = cn\\pi/L$\n\n**5. General solution:**\n$$u(x,t) = \\sum_{n=1}^{\\infty} \\left[A_n \\cos(\\omega_n t) + B_n \\sin(\\omega_n t)\\right] \\sin\\left(\\frac{n\\pi x}{L}\\right)$$\n\n**6. Match initial conditions:**\n- $u(x,0) = f(x)$ determines $A_n$\n- $\\frac{\\partial u}{\\partial t}(x,0) = g(x)$ determines $B_n$\n\n### Example 3: Laplace Equation (2D Rectangle)\n\n**Problem:** Steady-state temperature in rectangular plate\n\n**PDE:** $\\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = 0$\n\n**Domain:** $0 \\le x \\le a$, $0 \\le y \\le b$\n\n**Boundary conditions:**\n- $u(0,y) = 0$, $u(a,y) = 0$ (left/right edges cold)\n- $u(x,0) = 0$, $u(x,b) = f(x)$ (bottom cold, top has temperature profile)\n\n**Solution Steps:**\n\n**1. Assume:** $u(x,y) = X(x) Y(y)$\n\n**2. Substitute and separate:**\n$$\\frac{X''(x)}{X(x)} + \\frac{Y''(y)}{Y(y)} = 0$$\n\n$$\\frac{X''(x)}{X(x)} = -\\frac{Y''(y)}{Y(y)} = -\\lambda$$\n\n**3. Two ODEs:**\n- $X''(x) + \\lambda X(x) = 0$\n- $Y''(y) - \\lambda Y(y) = 0$\n\n**4. Apply boundary conditions in $x$:**\n\n$X(0) = 0$, $X(a) = 0$ give:\n$$\\lambda_n = \\left(\\frac{n\\pi}{a}\\right)^2, \\quad X_n(x) = \\sin\\left(\\frac{n\\pi x}{a}\\right)$$\n\n**5. Solve $Y$ equation:**\n$$Y_n(y) = C_n \\sinh\\left(\\frac{n\\pi y}{a}\\right)$$\n\n(Using $Y(0) = 0$)\n\n**6. General solution:**\n$$u(x,y) = \\sum_{n=1}^{\\infty} C_n \\sin\\left(\\frac{n\\pi x}{a}\\right) \\sinh\\left(\\frac{n\\pi y}{a}\\right)$$\n\n**7. Match boundary condition at $y = b$:**\n$$u(x,b) = f(x) = \\sum_{n=1}^{\\infty} C_n \\sinh\\left(\\frac{n\\pi b}{a}\\right) \\sin\\left(\\frac{n\\pi x}{a}\\right)$$\n\nCoefficients:\n$$C_n = \\frac{2}{a \\sinh(n\\pi b/a)} \\int_0^a f(x) \\sin\\left(\\frac{n\\pi x}{a}\\right) dx$$\n\n## Eigenvalue Problems\n\n**Central concept:** Separation of variables converts PDEs to **eigenvalue problems**\n\n**Sturm-Liouville form:**\n$$\\frac{d}{dx}\\left[p(x)\\frac{dX}{dx}\\right] + q(x)X + \\lambda w(x)X = 0$$\n\nwith boundary conditions.\n\n**Key properties:**\n1. **Eigenvalues are real** and can be ordered: $\\lambda_1 < \\lambda_2 < \\lambda_3 < \\cdots$\n2. **Eigenfunctions are orthogonal** (with weight function $w(x)$)\n3. **Eigenfunctions form complete basis** (any function can be expanded in them)\n\n**Example (Dirichlet BCs on [0,L]):**\n- Eigenvalues: $\\lambda_n = (n\\pi/L)^2$\n- Eigenfunctions: $\\sin(n\\pi x/L)$\n- Orthogonality: $\\int_0^L \\sin(m\\pi x/L) \\sin(n\\pi x/L) dx = 0$ if $m \\ne n$\n\n## Fourier Series Expansion\n\n**The general solution is a Fourier series:**\n\n$$u(x,t) = \\sum_{n=1}^{\\infty} a_n(t) X_n(x)$$\n\nwhere $X_n(x)$ are eigenfunctions.\n\n**Coefficients from initial conditions:**\n$$a_n(0) = \\frac{\\langle f, X_n \\rangle}{\\langle X_n, X_n \\rangle}$$\n\nwhere $\\langle \\cdot, \\cdot \\rangle$ is inner product with weight function.\n\nFor $X_n = \\sin(n\\pi x/L)$ on $[0,L]$:\n$$a_n(0) = \\frac{2}{L} \\int_0^L f(x) \\sin(n\\pi x/L) dx$$\n\n**⚠️ MathHook Limitation:** Currently returns **symbolic coefficients** ($A_1, A_2, \\ldots$). Numerical evaluation requires symbolic integration (planned for Phase 2).\n\n## When Separation of Variables Works\n\n**✅ Requirements:**\n1. **Linear PDE** (otherwise product form invalid)\n2. **Constant coefficients** or separable coefficients\n3. **Rectangular domain** or simple geometry\n4. **Separable boundary conditions** (each BC involves only one variable)\n\n**✅ Works for:**\n- Heat equation\n- Wave equation\n- Laplace equation\n- Schrödinger equation (quantum mechanics)\n- Many diffusion/wave problems\n\n**❌ Doesn't work for:**\n- Nonlinear PDEs\n- Complex geometries (use finite elements)\n- Non-separable boundary conditions\n- Time-dependent coefficients\n\n## Common Pitfalls\n\n### 1. Wrong Sign for Separation Constant\n\n**Common mistake:** Using $+\\lambda$ instead of $-\\lambda$\n\n**Result:** Exponential growth instead of sinusoidal eigenfunctions\n\n**Fix:** Check boundary conditions - usually need sinusoidal solutions\n\n### 2. Forgetting Homogeneous Boundary Conditions\n\nSeparation of variables requires **homogeneous BCs** ($u = 0$ or $\\frac{\\partial u}{\\partial n} = 0$ at boundaries).\n\n**Non-homogeneous BCs:** Use **change of variables** to make homogeneous first.\n\n### 3. Incomplete Superposition\n\n**Mistake:** Using only one eigenfunction\n\n**Fix:** General solution is **infinite series** (superposition of all eigenfunctions)\n"
  },
  "use_cases": [
    "Solving heat equations with boundary conditions",
    "Analyzing wave propagation in bounded domains",
    "Computing equilibrium distributions (Laplace equation)",
    "Quantum mechanics: Solving Schrödinger equation in potential wells"
  ],
  "related_topics": [
    "advanced.pde.heat_equation",
    "advanced.pde.wave_equation",
    "advanced.pde.laplace_equation",
    "advanced.pde.examples"
  ],
  "performance": {
    "complexity": "O(n) for n eigenvalues/modes",
    "typical_time": "1-5ms for setup, varies by PDE complexity"
  },
  "outputs": {
    "jupyter": {
      "include_interactive_plots": false,
      "include_performance_section": false
    },
    "mdbook": {
      "include_mathematical_proof": true,
      "include_implementation_details": false,
      "runnable_code": true
    },
    "vue_site": {
      "include_live_demo": false,
      "seo_keywords": [
        "separation of variables",
        "PDE method",
        "eigenvalue problems",
        "Fourier series"
      ]
    },
    "api_docs": {
      "include_playground": false,
      "show_all_languages": true
    },
    "llm_rag": {
      "chunk_strategy": "by_example",
      "max_chunk_size": 1024,
      "embedding_priority": "medium"
    }
  },
  "metadata": {
    "schema_version": "1.0"
  }
}