{
  "topic": "pde.wave-equation",
  "title": "The Wave Equation",
  "description": "The wave equation is a fundamental hyperbolic PDE describing wave propagation\nin vibrating strings, sound, light, and other wave phenomena. It models how\ndisturbances propagate through space and time.\n",
  "mathematical_definition": "$$\\frac{\\partial^2 u}{\\partial t^2} = c^2 \\nabla^2 u$$\n\nwhere $u(x,t)$ is displacement, $c$ is wave speed, and $\\nabla^2$ is the Laplacian.\n\nIn 1D: $$\\frac{\\partial^2 u}{\\partial t^2} = c^2 \\frac{\\partial^2 u}{\\partial x^2}$$\n",
  "code_refs": {
    "rust": "mathhook_core::pde::wave_equation",
    "python": "mathhook.pde.wave_equation",
    "nodejs": "mathhook.pde.waveEquation"
  },
  "quick_reference": {
    "standard_form": "$\\frac{\\partial^2 u}{\\partial t^2} = c^2 \\nabla^2 u$",
    "type": "Hyperbolic PDE (second-order in both space and time)",
    "principle": "Disturbances propagate at constant speed $c$",
    "solution_methods": [
      "d'Alembert's formula (1D traveling waves)",
      "Separation of variables (standing waves)",
      "Method of characteristics",
      "Fourier transform",
      "Numerical methods (finite difference, spectral)"
    ],
    "key_properties": [
      "Finite propagation speed: disturbances travel at speed $c$",
      "Energy conservation: total energy constant over time",
      "Reversibility: can run backwards in time",
      "Superposition: sum of solutions is a solution"
    ]
  },
  "examples": [
    {
      "title": "1D Wave Equation: d'Alembert's Solution",
      "explanation": "The general solution of the 1D wave equation on infinite domain is:\n$$u(x,t) = f(x - ct) + g(x + ct)$$\n\nwhere $f$ and $g$ are arbitrary functions representing right-moving and\nleft-moving waves.\n\nFor initial conditions $u(x,0) = \\phi(x)$ and $u_t(x,0) = \\psi(x)$:\n$$u(x,t) = \\frac{\\phi(x-ct) + \\phi(x+ct)}{2} + \\frac{1}{2c}\\int_{x-ct}^{x+ct} \\psi(s)ds$$\n",
      "code": {
        "python": "from mathhook import pde, symbols, expr\nimport numpy as np\n\nx, t, c = symbols('x t c')\n\n# Define initial displacement and velocity\nphi = expr('exp(-x^2)')  # Initial shape (Gaussian)\npsi = expr('0')          # Initially at rest\n\n# d'Alembert solution\nsolution = pde.dalembert_solution(phi, psi, c)\nprint(f\"Solution: {solution}\")\n\n# Evaluate at specific point and time\nu_val = solution.subs({x: 1.0, t: 0.5, c: 1.0})\nprint(f\"u(1.0, 0.5) = {u_val}\")\n\n# Numerical evaluation\ndef evaluate_wave(x_val, t_val, c_val=1.0):\n    \"\"\"Evaluate d'Alembert solution numerically\"\"\"\n    # Right-moving and left-moving components\n    f_right = np.exp(-(x_val - c_val*t_val)**2)\n    f_left = np.exp(-(x_val + c_val*t_val)**2)\n    return (f_right + f_left) / 2\n\n# Create animation data\nx_vals = np.linspace(-5, 5, 200)\nfor t_val in [0, 0.5, 1.0, 1.5, 2.0]:\n    u_vals = [evaluate_wave(x, t_val) for x in x_vals]\n    print(f\"t = {t_val}: wave split into two pulses\")\n",
        "rust": "use mathhook::pde::*;\nuse mathhook::{expr, symbol};\n\nlet [x, t, c] = symbols![x, t, c];\n\n// Initial conditions\nlet phi = expr!(exp(-x^2));  // Initial displacement\nlet psi = expr!(0);          // Initial velocity\n\n// d'Alembert solution\nlet wave_eq = WaveEquation::new(c.clone());\nlet solution = wave_eq.dalembert_solution(&phi, &psi);\n\nprintln!(\"Solution: {}\", solution);\n\n// Evaluate at point\nlet u_val = solution\n    .substitute(&x, &expr!(1.0))\n    .substitute(&t, &expr!(0.5))\n    .substitute(&c, &expr!(1.0))\n    .evaluate();\n",
        "nodejs": "const { pde, symbols, expr } = require('mathhook');\n\nconst [x, t, c] = symbols('x', 't', 'c');\n\n// Initial conditions\nconst phi = expr('exp(-x^2)');\nconst psi = expr('0');\n\n// d'Alembert solution\nconst solution = pde.dalembertSolution(phi, psi, c);\nconsole.log(`Solution: ${solution}`);\n\n// Evaluate\nconst uVal = solution\n  .subs(x, 1.0)\n  .subs(t, 0.5)\n  .subs(c, 1.0);\nconsole.log(`u(1.0, 0.5) = ${uVal}`);\n"
      },
      "expected_output": "$$u(x,t) = \\frac{e^{-(x-ct)^2} + e^{-(x+ct)^2}}{2}$$\n\nThe initial Gaussian pulse splits into two equal pulses traveling in opposite directions.\n"
    },
    {
      "title": "Vibrating String with Fixed Ends",
      "explanation": "A string of length $L$ with fixed ends satisfies:\n\nPDE: $\\frac{\\partial^2 u}{\\partial t^2} = c^2 \\frac{\\partial^2 u}{\\partial x^2}$, $0 < x < L$\n\nBoundary conditions: $u(0,t) = 0$, $u(L,t) = 0$\n\nInitial conditions: $u(x,0) = f(x)$, $u_t(x,0) = g(x)$\n\nSolution (standing wave expansion):\n$$u(x,t) = \\sum_{n=1}^{\\infty} \\left[a_n \\cos\\left(\\frac{n\\pi ct}{L}\\right) + b_n \\sin\\left(\\frac{n\\pi ct}{L}\\right)\\right] \\sin\\left(\\frac{n\\pi x}{L}\\right)$$\n\nwhere:\n- $a_n = \\frac{2}{L}\\int_0^L f(x)\\sin\\left(\\frac{n\\pi x}{L}\\right)dx$\n- $b_n = \\frac{2}{n\\pi c}\\int_0^L g(x)\\sin\\left(\\frac{n\\pi x}{L}\\right)dx$\n",
      "code": {
        "python": "from mathhook import pde, symbols, expr\n\nx, t, L, c = symbols('x t L c')\nu = pde.Function('u', [x, t])\n\n# Wave equation\nwave_eq = pde.wave_equation(u, x, t, c)\n\n# Fixed boundary conditions\nbc1 = u.subs(x, 0) == 0\nbc2 = u.subs(x, L) == 0\n\n# Initial displacement (plucked string shape)\nic_displacement = u.subs(t, 0) == expr('x*(L-x)')\n\n# Initial velocity (released from rest)\nic_velocity = u.diff(t).subs(t, 0) == 0\n\n# Solve using separation of variables\nsolution = pde.solve_wave_equation(\n    wave_eq,\n    boundary_conditions=[bc1, bc2],\n    initial_conditions={\n        'displacement': ic_displacement,\n        'velocity': ic_velocity\n    },\n    domain={'x': (0, L), 't': (0, float('inf'))},\n    method='separation_of_variables'\n)\n\nprint(f\"Solution (standing waves): {solution}\")\n\n# Extract fundamental frequency\nfundamental = solution.get_mode(n=1)\nprint(f\"Fundamental mode: {fundamental}\")\nprint(f\"Frequency: {c/(2*L)} Hz\")\n",
        "rust": "use mathhook::pde::*;\n\nlet [x, t, L, c] = symbols![x, t, L, c];\n\n// Wave equation setup\nlet wave_eq = WaveEquation::new(c.clone());\n\n// Boundary conditions (fixed ends)\nlet bc = BoundaryConditions::dirichlet(vec![\n    (expr!(0), expr!(0)),\n    (L.clone(), expr!(0)),\n]);\n\n// Initial conditions\nlet ic_displacement = expr!(x * (L - x));\nlet ic_velocity = expr!(0);\n\n// Solve\nlet solution = wave_eq.solve_separation_variables(\n    &bc,\n    &InitialConditions::new(ic_displacement, ic_velocity),\n    Domain::rectangular((expr!(0), L), (expr!(0), expr!(inf)))\n);\n\n// Extract modes\nlet fundamental = solution.mode(1);\nprintln!(\"Fundamental frequency: \u03c0*c/L\");\n",
        "nodejs": "const { pde, symbols, expr } = require('mathhook');\n\nconst [x, t, L, c] = symbols('x', 't', 'L', 'c');\n\nconst solution = pde.solveWaveEquation({\n  c,\n  domain: { x: [0, L], t: [0, Infinity] },\n  boundaryConditions: 'dirichlet_zero',\n  initialDisplacement: expr('x*(L-x)'),\n  initialVelocity: expr('0'),\n  method: 'separationOfVariables'\n});\n\nconst fundamental = solution.getMode(1);\nconsole.log(`Fundamental: ${fundamental}`);\n"
      },
      "expected_output": "$$u(x,t) = \\sum_{n=1,3,5,...} \\frac{8L^2}{n^3\\pi^3} \\cos\\left(\\frac{n\\pi ct}{L}\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right)$$\n\nOnly odd harmonics appear (symmetric initial shape).\nFundamental frequency: $f_1 = c/(2L)$\n"
    },
    {
      "title": "2D Wave Equation: Vibrating Membrane",
      "explanation": "A rectangular membrane $[0,a] \\times [0,b]$ with fixed edges:\n\nPDE: $\\frac{\\partial^2 u}{\\partial t^2} = c^2 \\left(\\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2}\\right)$\n\nSolution:\n$$u(x,y,t) = \\sum_{m=1}^{\\infty}\\sum_{n=1}^{\\infty} \\left[A_{mn}\\cos(\\omega_{mn}t) + B_{mn}\\sin(\\omega_{mn}t)\\right] \\sin\\left(\\frac{m\\pi x}{a}\\right)\\sin\\left(\\frac{n\\pi y}{b}\\right)$$\n\nwhere $\\omega_{mn} = c\\pi\\sqrt{(m/a)^2 + (n/b)^2}$ are the natural frequencies.\n",
      "code": {
        "python": "from mathhook import pde, symbols\n\nx, y, t, a, b, c = symbols('x y t a b c')\n\n# 2D wave equation\nwave_eq_2d = pde.wave_equation_2d(c)\n\n# Fixed boundary\nbc = pde.BoundaryConditions.dirichlet_rectangle(\n    x_range=(0, a),\n    y_range=(0, b),\n    value=0\n)\n\n# Initial displacement (center struck)\nic_disp = expr('sin(pi*x/a) * sin(pi*y/b)')\nic_vel = expr('0')\n\nsolution = pde.solve_wave_equation_2d(\n    wave_eq_2d,\n    boundary_conditions=bc,\n    initial_displacement=ic_disp,\n    initial_velocity=ic_vel\n)\n\n# Natural frequencies\nfreqs = pde.natural_frequencies_2d(c, a, b, max_mode=5)\nprint(f\"Natural frequencies: {freqs}\")\n",
        "rust": "use mathhook::pde::*;\n\nlet [x, y, t, a, b, c] = symbols![x, y, t, a, b, c];\n\nlet wave_eq = WaveEquation2D::new(c);\n\nlet bc = BoundaryConditions::dirichlet_rectangle(\n    (expr!(0), a.clone()),\n    (expr!(0), b.clone()),\n    expr!(0)\n);\n\nlet ic = InitialConditions::new(\n    expr!(sin(pi * x / a) * sin(pi * y / b)),\n    expr!(0)\n);\n\nlet solution = wave_eq.solve_separation_variables(&bc, &ic);\n\n// Natural frequencies: \u03c9_mn = c*\u03c0*sqrt((m/a)^2 + (n/b)^2)\nlet freqs = wave_eq.natural_frequencies(&a, &b, 5);\n",
        "nodejs": "const { pde, symbols, expr } = require('mathhook');\n\nconst [x, y, t, a, b, c] = symbols('x', 'y', 't', 'a', 'b', 'c');\n\nconst solution = pde.solveWaveEquation2D({\n  c,\n  domain: { x: [0, a], y: [0, b] },\n  boundaryConditions: 'dirichlet_zero',\n  initialDisplacement: expr('sin(pi*x/a) * sin(pi*y/b)'),\n  initialVelocity: expr('0')\n});\n\nconst freqs = pde.naturalFrequencies2D(c, a, b, { maxMode: 5 });\n"
      },
      "expected_output": "For $(m,n) = (1,1)$ mode:\n$$u(x,y,t) = \\cos\\left(c\\pi\\sqrt{\\frac{1}{a^2}+\\frac{1}{b^2}}t\\right) \\sin\\left(\\frac{\\pi x}{a}\\right)\\sin\\left(\\frac{\\pi y}{b}\\right)$$\n\nFundamental frequency: $\\omega_{11} = c\\pi\\sqrt{1/a^2 + 1/b^2}$\n"
    }
  ],
  "article": {
    "sections": [
      {
        "heading": "Physical Interpretation",
        "content": "The wave equation describes oscillatory motion with finite propagation speed:\n\n- **$u(x,t)$**: Displacement from equilibrium\n- **$c$**: Wave speed (depends on medium properties)\n- **$\\frac{\\partial^2 u}{\\partial t^2}$**: Acceleration\n- **$\\nabla^2 u$**: Spatial curvature (restoring force)\n\n**Physical examples**:\n- Vibrating strings and membranes (musical instruments)\n- Sound waves in air and solids\n- Electromagnetic waves (light)\n- Water surface waves (shallow water approximation)\n- Seismic waves in Earth's crust\n\n**Wave speed formula**:\n- String: $c = \\sqrt{T/\\rho}$ where $T$ is tension, $\\rho$ is linear mass density\n- Sound: $c = \\sqrt{\\gamma P/\\rho}$ where $\\gamma$ is heat capacity ratio, $P$ is pressure\n- Electromagnetic: $c = 1/\\sqrt{\\mu_0\\epsilon_0}$ (speed of light in vacuum)\n"
      },
      {
        "heading": "d'Alembert's Formula (1D Traveling Waves)",
        "content": "The general solution of the 1D wave equation is:\n$$u(x,t) = f(x - ct) + g(x + ct)$$\n\n**Interpretation**:\n- $f(x - ct)$: Right-moving wave (shape $f$ traveling right at speed $c$)\n- $g(x + ct)$: Left-moving wave (shape $g$ traveling left at speed $c$)\n\n**For initial conditions** $u(x,0) = \\phi(x)$ and $u_t(x,0) = \\psi(x)$:\n$$u(x,t) = \\frac{\\phi(x-ct) + \\phi(x+ct)}{2} + \\frac{1}{2c}\\int_{x-ct}^{x+ct} \\psi(s)ds$$\n\n**Key property**: Information at $(x,t)$ depends only on interval $[x-ct, x+ct]$ at $t=0$\n(domain of dependence). This reflects finite propagation speed.\n"
      },
      {
        "heading": "Separation of Variables (Standing Waves)",
        "content": "For bounded domains with boundary conditions, assume $u(x,t) = X(x)T(t)$:\n\n**Step 1**: Substitute into wave equation:\n$$X(x)T''(t) = c^2 X''(x)T(t)$$\n\n**Step 2**: Separate:\n$$\\frac{T''(t)}{c^2 T(t)} = \\frac{X''(x)}{X(x)} = -\\lambda$$\n\n**Step 3**: Solve spatial eigenvalue problem:\n$$X''(x) + \\lambda X(x) = 0$$\nwith boundary conditions to find $\\lambda_n$ and $X_n(x)$\n\n**Step 4**: Solve temporal ODE:\n$$T''(t) + c^2\\lambda_n T(t) = 0$$\ngiving $T_n(t) = A_n\\cos(\\omega_n t) + B_n\\sin(\\omega_n t)$ where $\\omega_n = c\\sqrt{\\lambda_n}$\n\n**Step 5**: General solution (standing waves):\n$$u(x,t) = \\sum_{n} \\left[A_n\\cos(\\omega_n t) + B_n\\sin(\\omega_n t)\\right]X_n(x)$$\n\nThese are standing waves with fixed spatial patterns $X_n(x)$ oscillating at frequencies $\\omega_n$.\n"
      },
      {
        "heading": "Energy Conservation",
        "content": "The wave equation conserves total energy:\n$$E(t) = \\frac{1}{2}\\int \\left[\\left(\\frac{\\partial u}{\\partial t}\\right)^2 + c^2|\\nabla u|^2\\right]dx$$\n\nwhere:\n- Kinetic energy: $\\frac{1}{2}\\int (u_t)^2 dx$\n- Potential energy: $\\frac{c^2}{2}\\int |\\nabla u|^2 dx$\n\n**Conservation law**: $\\frac{dE}{dt} = 0$ (energy remains constant over time)\n\n**Physical meaning**: Energy flows between kinetic and potential forms but total energy\nis conserved (no dissipation in the ideal wave equation).\n\n**Energy flux** (energy flow across boundaries):\n$$F = -c^2 u_t \\nabla u$$\n"
      },
      {
        "heading": "Finite Propagation Speed",
        "content": "Unlike the heat equation (infinite propagation speed), waves have finite propagation speed $c$.\n\n**Domain of dependence**: Solution at $(x,t)$ depends only on data within distance $ct$\nfrom $x$ at $t=0$.\n\n**Range of influence**: Initial data at $x_0$ affects only points within distance $ct$\nfrom $x_0$ at time $t$.\n\n**Sharp wavefronts**: Discontinuities in initial data propagate as sharp wavefronts,\nunlike heat equation which smooths immediately.\n\n**Huygens' principle** (odd spatial dimensions): Wavefronts are sharp with no trailing\ndisturbance. In even dimensions, waves leave a wake.\n"
      },
      {
        "heading": "Method of Characteristics",
        "content": "The 1D wave equation can be factored as:\n$$\\left(\\frac{\\partial}{\\partial t} - c\\frac{\\partial}{\\partial x}\\right)\\left(\\frac{\\partial}{\\partial t} + c\\frac{\\partial}{\\partial x}\\right)u = 0$$\n\n**Characteristic curves**: Lines $x - ct = \\text{const}$ and $x + ct = \\text{const}$ in spacetime\n\n**Characteristic variables**:\n- $\\xi = x - ct$ (right-moving characteristics)\n- $\\eta = x + ct$ (left-moving characteristics)\n\nIn $(\\xi, \\eta)$ coordinates, wave equation becomes:\n$$\\frac{\\partial^2 u}{\\partial \\xi \\partial \\eta} = 0$$\n\nSolution: $u = f(\\xi) + g(\\eta) = f(x-ct) + g(x+ct)$ (d'Alembert form)\n"
      },
      {
        "heading": "Numerical Methods",
        "content": "**Finite Difference (Explicit)**:\n$$u_i^{n+1} = 2u_i^n - u_i^{n-1} + \\left(\\frac{c\\Delta t}{\\Delta x}\\right)^2 (u_{i+1}^n - 2u_i^n + u_{i-1}^n)$$\n\n**CFL condition** (stability): $c\\frac{\\Delta t}{\\Delta x} \\leq 1$\n\nPhysical meaning: time step must be small enough that wave doesn't cross more than one\nspatial grid cell.\n\n**Spectral methods**: Represent solution as Fourier series, excellent for smooth solutions\n\n**Finite element methods**: Handle complex geometries and boundary conditions\n\n**Symplectic integrators**: Preserve energy conservation in long-time simulations\n"
      }
    ]
  },
  "use_cases": [
    "Acoustics: Sound propagation in air, water, and solids",
    "Musical instruments: String and membrane vibrations (guitar, drums)",
    "Electromagnetics: Radio waves, light propagation",
    "Seismology: Earthquake wave propagation through Earth",
    "Structural engineering: Building vibrations and resonance",
    "Quantum mechanics: Schr\u00f6dinger equation (wave-like behavior)"
  ],
  "related_topics": [
    "pde.heat-equation",
    "pde.laplace-equation",
    "calculus.fourier-series",
    "numerical.finite-difference",
    "physics.acoustics"
  ],
  "references": [
    {
      "title": "Partial Differential Equations",
      "author": "Lawrence C. Evans",
      "year": 2010,
      "publisher": "American Mathematical Society"
    },
    {
      "title": "The Wave Equation",
      "author": "A. G. Webster",
      "year": 1927,
      "publisher": "Dover Publications"
    },
    {
      "title": "Mathematical Methods for Physics and Engineering",
      "author": "Riley, Hobson, and Bence",
      "year": 2006,
      "publisher": "Cambridge University Press"
    }
  ],
  "performance": {
    "complexity": "O(n\u00b2) for separation of variables with n modes in 1D, O(n\u2074) for 2D with n\u00d7n modes, O(mn) for finite difference with m time steps and n spatial points",
    "typical_time": "< 50ms for analytical solution with 50 modes, 500ms-5s for numerical solution on 1000 grid points",
    "benchmarks": {
      "analytical_1d": "30ms for 100 modes",
      "dalembert_formula": "10ms for evaluation at 1000 points",
      "numerical_explicit_1d": "500ms for 1000 spatial points, 10000 time steps",
      "numerical_2d": "5s for 100\u00d7100 grid, 1000 time steps"
    }
  }
}