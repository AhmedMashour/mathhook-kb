{
  "topic": "pde.laplace-equation",
  "title": "The Laplace Equation",
  "description": "The Laplace equation is a fundamental elliptic PDE describing steady-state phenomena\nsuch as electrostatic potential, gravitational potential, and steady-state heat distribution.\nIt represents equilibrium with no time dependence.\n",
  "mathematical_definition": "$$\\nabla^2 u = 0$$\n\nwhere $u$ is the potential function and $\\nabla^2$ is the Laplacian operator.\n\nIn 2D: $$\\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = 0$$\n\nIn 3D: $$\\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} + \\frac{\\partial^2 u}{\\partial z^2} = 0$$\n",
  "code_refs": {
    "rust": "mathhook_core::pde::laplace_equation",
    "python": "mathhook.pde.laplace_equation",
    "nodejs": "mathhook.pde.laplaceEquation"
  },
  "quick_reference": {
    "standard_form": "$\\nabla^2 u = 0$",
    "type": "Elliptic PDE (steady-state, no time dependence)",
    "principle": "Potential satisfies local averaging property",
    "solution_methods": [
      "Separation of variables (rectangular, cylindrical, spherical coordinates)",
      "Green's function method",
      "Conformal mapping (2D)",
      "Numerical methods (finite difference, finite element, boundary element)"
    ],
    "key_properties": [
      "Maximum principle: extrema occur only on boundary",
      "Mean value property: value = average over any sphere",
      "Uniqueness: solution determined by boundary conditions",
      "Harmonic functions: smooth and infinitely differentiable"
    ]
  },
  "examples": [
    {
      "title": "2D Laplace Equation on Rectangle",
      "explanation": "Solve Laplace equation on rectangle $[0,a] \\times [0,b]$ with Dirichlet boundary conditions.\n\nProblem:\n$$\\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = 0$$\n\nBoundary conditions:\n- $u(0,y) = 0$\n- $u(a,y) = 0$\n- $u(x,0) = 0$\n- $u(x,b) = f(x)$ (non-zero top boundary)\n\nSolution:\n$$u(x,y) = \\sum_{n=1}^{\\infty} b_n \\frac{\\sinh(n\\pi y/a)}{\\sinh(n\\pi b/a)} \\sin\\left(\\frac{n\\pi x}{a}\\right)$$\n\nwhere $b_n = \\frac{2}{a}\\int_0^a f(x)\\sin\\left(\\frac{n\\pi x}{a}\\right)dx$\n",
      "code": {
        "python": "from mathhook import pde, symbols, expr\n\nx, y, a, b = symbols('x y a b')\nu = pde.Function('u', [x, y])\n\n# Laplace equation\nlaplace_eq = pde.laplace_equation(u, [x, y])\n\n# Boundary conditions\nbc_left = u.subs(x, 0) == 0\nbc_right = u.subs(x, a) == 0\nbc_bottom = u.subs(y, 0) == 0\nbc_top = u.subs(y, b) == expr('sin(pi*x/a)')  # Example: sine on top\n\n# Solve using separation of variables\nsolution = pde.solve_laplace(\n    laplace_eq,\n    boundary_conditions={\n        'left': bc_left,\n        'right': bc_right,\n        'bottom': bc_bottom,\n        'top': bc_top\n    },\n    domain={'x': (0, a), 'y': (0, b)},\n    method='separation_of_variables'\n)\n\nprint(f\"Solution: {solution}\")\n\n# Evaluate at specific point\nu_center = solution.subs({x: a/2, y: b/2})\nprint(f\"u(a/2, b/2) = {u_center}\")\n",
        "rust": "use mathhook::pde::*;\n\nlet [x, y, a, b] = symbols![x, y, a, b];\n\n// Laplace equation\nlet laplace_eq = LaplaceEquation::new(2); // 2D\n\n// Boundary conditions\nlet bc = BoundaryConditions::rectangle()\n    .left(expr!(0))\n    .right(expr!(0))\n    .bottom(expr!(0))\n    .top(expr!(sin(pi * x / a)));\n\n// Solve\nlet solution = laplace_eq.solve_separation_variables(\n    &bc,\n    Domain::rectangular((expr!(0), a), (expr!(0), b))\n);\n\nprintln!(\"Solution: {}\", solution);\n",
        "nodejs": "const { pde, symbols, expr } = require('mathhook');\n\nconst [x, y, a, b] = symbols('x', 'y', 'a', 'b');\n\nconst solution = pde.solveLaplace({\n  dimensions: 2,\n  domain: { x: [0, a], y: [0, b] },\n  boundaryConditions: {\n    left: 0,\n    right: 0,\n    bottom: 0,\n    top: expr('sin(pi*x/a)')\n  },\n  method: 'separationOfVariables'\n});\n\nconst uCenter = solution.subs({ x: a/2, y: b/2 });\nconsole.log(`u(a/2, b/2) = ${uCenter}`);\n"
      },
      "expected_output": "For $f(x) = \\sin(\\pi x/a)$, only $n=1$ term survives:\n$$u(x,y) = \\frac{\\sinh(\\pi y/a)}{\\sinh(\\pi b/a)} \\sin\\left(\\frac{\\pi x}{a}\\right)$$\n"
    },
    {
      "title": "Polar Coordinates: Disk with Dirichlet Boundary",
      "explanation": "Solve Laplace equation inside disk of radius $R$ with boundary condition $u(R,\\theta) = f(\\theta)$.\n\nIn polar coordinates:\n$$\\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial u}{\\partial r}\\right) + \\frac{1}{r^2}\\frac{\\partial^2 u}{\\partial \\theta^2} = 0$$\n\nGeneral solution:\n$$u(r,\\theta) = a_0 + \\sum_{n=1}^{\\infty} r^n(a_n\\cos(n\\theta) + b_n\\sin(n\\theta))$$\n\nFor boundary $u(R,\\theta) = f(\\theta)$:\n$$u(r,\\theta) = \\frac{a_0}{2} + \\sum_{n=1}^{\\infty} \\left(\\frac{r}{R}\\right)^n[a_n\\cos(n\\theta) + b_n\\sin(n\\theta)]$$\n\nwhere:\n- $a_0 = \\frac{1}{\\pi}\\int_0^{2\\pi} f(\\theta)d\\theta$\n- $a_n = \\frac{1}{\\pi}\\int_0^{2\\pi} f(\\theta)\\cos(n\\theta)d\\theta$\n- $b_n = \\frac{1}{\\pi}\\int_0^{2\\pi} f(\\theta)\\sin(n\\theta)d\\theta$\n",
      "code": {
        "python": "from mathhook import pde, symbols, expr\nimport numpy as np\n\nr, theta, R = symbols('r theta R')\n\n# Laplace in polar coordinates\nlaplace_polar = pde.laplace_polar(r, theta)\n\n# Boundary condition (example: theta)\nboundary_func = theta  # u(R, theta) = theta\n\n# Solve using Fourier series\nsolution = pde.solve_laplace_disk(\n    radius=R,\n    boundary_condition=boundary_func,\n    max_modes=50\n)\n\nprint(f\"Solution: {solution}\")\n\n# Poisson integral formula (alternative)\ndef poisson_kernel(r_val, theta_val, theta_prime, R_val):\n    \"\"\"Poisson kernel for disk\"\"\"\n    numerator = R_val**2 - r_val**2\n    denominator = R_val**2 - 2*R_val*r_val*np.cos(theta_val - theta_prime) + r_val**2\n    return numerator / denominator\n\ndef evaluate_disk_solution(f_boundary, r_val, theta_val, R_val):\n    \"\"\"Evaluate using Poisson integral formula\"\"\"\n    from scipy.integrate import quad\n\n    def integrand(theta_prime):\n        kernel = poisson_kernel(r_val, theta_val, theta_prime, R_val)\n        return f_boundary(theta_prime) * kernel\n\n    result, _ = quad(integrand, 0, 2*np.pi)\n    return result / (2*np.pi)\n\n# Example evaluation\nu_center = evaluate_disk_solution(\n    lambda t: t,  # boundary = theta\n    r_val=0,\n    theta_val=0,\n    R_val=1.0\n)\nprint(f\"u(0, 0) = {u_center}\")  # Should be \u03c0 (average of boundary)\n",
        "rust": "use mathhook::pde::*;\n\nlet [r, theta, R] = symbols![r, theta, R];\n\n// Laplace in polar coordinates\nlet laplace_polar = LaplaceEquation::polar();\n\n// Boundary condition\nlet bc = expr!(theta);  // u(R, theta) = theta\n\n// Solve\nlet solution = laplace_polar.solve_disk(R, bc, 50);\n\n// Evaluate at center (should be average of boundary)\nlet u_center = solution.substitute(&r, &expr!(0));\n",
        "nodejs": "const { pde, symbols, expr } = require('mathhook');\n\nconst [r, theta, R] = symbols('r', 'theta', 'R');\n\nconst solution = pde.solveLaplaceDisk({\n  radius: R,\n  boundaryCondition: theta,\n  maxModes: 50\n});\n\n// Poisson integral formula\nconst uCenter = pde.poissonIntegral({\n  boundaryFunction: theta,\n  r: 0,\n  theta: 0,\n  R: 1\n});\n"
      },
      "expected_output": "For $f(\\theta) = \\theta$:\n$$u(r,\\theta) = \\pi + 2\\sum_{n=1}^{\\infty} \\frac{(-1)^{n+1}}{n}\\left(\\frac{r}{R}\\right)^n \\sin(n\\theta)$$\n\nAt center: $u(0,\\theta) = \\pi$ (average of boundary values)\n"
    },
    {
      "title": "Spherical Harmonics: 3D Laplace on Sphere",
      "explanation": "Solve Laplace equation outside or inside a sphere using spherical coordinates.\n\nIn spherical coordinates $(r,\\theta,\\phi)$:\n$$\\frac{1}{r^2}\\frac{\\partial}{\\partial r}\\left(r^2\\frac{\\partial u}{\\partial r}\\right) + \\frac{1}{r^2\\sin\\theta}\\frac{\\partial}{\\partial \\theta}\\left(\\sin\\theta\\frac{\\partial u}{\\partial \\theta}\\right) + \\frac{1}{r^2\\sin^2\\theta}\\frac{\\partial^2 u}{\\partial \\phi^2} = 0$$\n\nGeneral solution:\n$$u(r,\\theta,\\phi) = \\sum_{l=0}^{\\infty}\\sum_{m=-l}^{l} \\left[A_{lm}r^l + B_{lm}r^{-(l+1)}\\right] Y_l^m(\\theta,\\phi)$$\n\nwhere $Y_l^m$ are spherical harmonics.\n",
      "code": {
        "python": "from mathhook import pde, symbols, special\n\nr, theta, phi, R = symbols('r theta phi R')\n\n# Spherical harmonics basis\nY_lm = special.spherical_harmonic\n\n# Laplace equation in spherical coordinates\nlaplace_spherical = pde.laplace_spherical(r, theta, phi)\n\n# Example: Exterior problem with boundary u(R, theta, phi) = cos(theta)\n# Note: cos(theta) = sqrt(4*pi/3) * Y_1^0(theta, phi)\n\n# Solution outside sphere (r > R)\ndef solve_exterior_sphere(R_val, l_max=10):\n    \"\"\"Solve Laplace equation exterior to sphere\"\"\"\n    solution_terms = []\n\n    for l in range(l_max + 1):\n        for m in range(-l, l + 1):\n            # Coefficient from boundary condition\n            A_lm = compute_coefficient(l, m, R_val)\n\n            # Exterior solution: decays as r^(-(l+1))\n            term = A_lm * (R_val**(2*l+1) / r**(l+1)) * Y_lm(l, m, theta, phi)\n            solution_terms.append(term)\n\n    return sum(solution_terms)\n\n# For boundary = cos(theta) = Y_1^0 (up to normalization):\n# Only l=1, m=0 term survives\nsolution = expr('(R^3 / r^2) * cos(theta)')\nprint(f\"Solution: {solution}\")\n",
        "rust": "use mathhook::pde::*;\nuse mathhook::special::spherical_harmonic;\n\nlet [r, theta, phi, R] = symbols![r, theta, phi, R];\n\n// Laplace in spherical coordinates\nlet laplace = LaplaceEquation::spherical();\n\n// Boundary condition (example: cos(theta) = dipole field)\nlet bc = expr!(cos(theta));\n\n// Solve exterior problem\nlet solution = laplace.solve_exterior_sphere(R, bc, l_max: 10);\n\n// For dipole: u(r, theta, phi) = (R^3/r^2) * cos(theta)\n",
        "nodejs": "const { pde, symbols, expr } = require('mathhook');\n\nconst [r, theta, phi, R] = symbols('r', 'theta', 'phi', 'R');\n\nconst solution = pde.solveLaplaceSphere({\n  radius: R,\n  region: 'exterior',\n  boundaryCondition: expr('cos(theta)'),\n  maxDegree: 10\n});\n\nconsole.log(`Solution: ${solution}`);\n"
      },
      "expected_output": "For boundary $u(R,\\theta,\\phi) = \\cos\\theta$ (dipole field):\n$$u(r,\\theta,\\phi) = \\frac{R^3}{r^2}\\cos\\theta \\quad (r > R)$$\n\nThis is the electrostatic potential outside a grounded conducting sphere in a uniform field.\n"
    }
  ],
  "article": {
    "sections": [
      {
        "heading": "Physical Interpretation and Applications",
        "content": "The Laplace equation describes steady-state (time-independent) potential fields:\n\n**Electrostatics**: $\\nabla^2 \\phi = 0$ where $\\phi$ is electric potential in charge-free regions\n\n**Gravitation**: $\\nabla^2 \\Phi = 0$ where $\\Phi$ is gravitational potential in mass-free regions\n\n**Steady-state heat**: $\\nabla^2 T = 0$ where $T$ is temperature at equilibrium\n\n**Fluid flow**: $\\nabla^2 \\psi = 0$ where $\\psi$ is stream function for irrotational, incompressible flow\n\n**Solutions (harmonic functions)** represent:\n- Equilibrium configurations (minimal energy)\n- Smooth interpolation between boundary values\n- Potential fields with no sources or sinks\n"
      },
      {
        "heading": "Maximum Principle",
        "content": "**Strong Maximum Principle**: If $u$ is harmonic in a connected domain $\\Omega$, then:\n\n1. Maximum and minimum occur on the boundary $\\partial\\Omega$\n2. If $u$ attains maximum (or minimum) at an interior point, then $u$ is constant\n\n**Physical interpretation**: In equilibrium, temperature/potential cannot have interior extrema\n- hottest/coldest points are on boundary\n- highest/lowest potential is on boundary\n\n**Consequences**:\n- Uniqueness of solutions (given boundary conditions)\n- Comparison principles\n- Stability: small changes in boundary \u2192 small changes in solution\n"
      },
      {
        "heading": "Mean Value Property",
        "content": "For harmonic function $u$, the value at any point equals the average over any sphere\n(or circle in 2D) centered at that point:\n\n**3D**: $$u(x_0) = \\frac{1}{4\\pi R^2}\\int_{|x-x_0|=R} u(x)dS$$\n\n**2D**: $$u(x_0) = \\frac{1}{2\\pi R}\\int_{|x-x_0|=R} u(x)ds$$\n\n**Interpretation**: Harmonic functions are \"perfectly balanced\" - value at any point\nis average of nearby values.\n\n**Converse**: If a function satisfies mean value property, it is harmonic.\n"
      },
      {
        "heading": "Separation of Variables",
        "content": "Coordinate systems aligned with domain geometry:\n\n**Rectangular (Cartesian)**: $u(x,y,z) = X(x)Y(y)Z(z)$\n- Natural for rectangular domains\n- Leads to sine/cosine expansions\n\n**Cylindrical**: $u(r,\\theta,z) = R(r)\\Theta(\\theta)Z(z)$\n- Natural for cylindrical geometries\n- Leads to Bessel functions + Fourier series\n\n**Spherical**: $u(r,\\theta,\\phi) = R(r)Y(\\theta,\\phi)$\n- Natural for spherical geometries\n- Leads to spherical harmonics\n\nEach coordinate system produces orthogonal function expansions suited to the geometry.\n"
      },
      {
        "heading": "Green's Functions",
        "content": "The fundamental solution of Laplace equation:\n\n**3D**: $$G(x,x_0) = -\\frac{1}{4\\pi|x-x_0|}$$\n\n**2D**: $$G(x,x_0) = -\\frac{1}{2\\pi}\\ln|x-x_0|$$\n\n**Physical meaning**: Potential from point source at $x_0$\n\n**Green's representation formula** (solution in terms of boundary values):\n$$u(x) = \\int_{\\partial\\Omega} \\left[u(y)\\frac{\\partial G}{\\partial n}(x,y) - G(x,y)\\frac{\\partial u}{\\partial n}(y)\\right]dS_y$$\n\nwhere $\\frac{\\partial}{\\partial n}$ is normal derivative.\n\nThis expresses solution as superposition of point source contributions from boundary.\n"
      },
      {
        "heading": "Conformal Mapping (2D)",
        "content": "In 2D, conformal maps preserve harmonic functions:\n\n**Theorem**: If $f: \\Omega_1 \\to \\Omega_2$ is conformal (analytic and one-to-one), and\n$u$ is harmonic in $\\Omega_2$, then $u \\circ f$ is harmonic in $\\Omega_1$.\n\n**Strategy**:\n1. Map complex domain $\\Omega$ to simple domain (disk, half-plane, rectangle)\n2. Solve Laplace equation in simple domain\n3. Map solution back to original domain\n\n**Common mappings**:\n- M\u00f6bius transforms: map circles to circles\n- Joukowsky transform: airfoil shapes\n- Schwarz-Christoffel: polygons to half-plane\n"
      },
      {
        "heading": "Numerical Methods",
        "content": "**Finite Difference**:\n5-point stencil (2D):\n$$u_{i,j} = \\frac{u_{i+1,j} + u_{i-1,j} + u_{i,j+1} + u_{i,j-1}}{4}$$\n\nSolve linear system $Au = b$ where $A$ is sparse.\n\n**Finite Element Method**:\n- Variational formulation: minimize energy functional\n- Handles complex geometries and mixed boundary conditions\n- Adaptive mesh refinement\n\n**Boundary Element Method**:\n- Only discretize boundary (not interior)\n- Uses Green's function representation\n- Efficient for exterior problems\n\n**Multigrid methods**: Fast iterative solvers ($O(n)$ complexity)\n"
      }
    ]
  },
  "use_cases": [
    "Electrostatics: Electric potential from charged conductors",
    "Gravitation: Gravitational potential in planetary systems",
    "Steady-state heat conduction: Temperature distribution at equilibrium",
    "Fluid dynamics: Potential flow around airfoils and obstacles",
    "Image processing: Poisson image editing and seamless cloning",
    "Finance: Optimal stopping and free boundary problems"
  ],
  "related_topics": [
    "pde.heat-equation",
    "pde.wave-equation",
    "pde.poisson-equation",
    "calculus.fourier-series",
    "special_functions.spherical-harmonics"
  ],
  "references": [
    {
      "title": "Partial Differential Equations",
      "author": "Lawrence C. Evans",
      "year": 2010,
      "publisher": "American Mathematical Society"
    },
    {
      "title": "Elliptic Partial Differential Equations of Second Order",
      "author": "David Gilbarg and Neil S. Trudinger",
      "year": 2001,
      "publisher": "Springer"
    },
    {
      "title": "A Course in Modern Mathematical Physics: Groups, Hilbert Space and Differential Geometry",
      "author": "Peter Szekeres",
      "year": 2004,
      "publisher": "Cambridge University Press"
    }
  ],
  "performance": {
    "complexity": "O(n\u00b3) for direct solve of linear system, O(n) for multigrid, O(n\u00b2log n) for FFT-based methods",
    "typical_time": "< 100ms for analytical solution with 50 Fourier modes, 100ms-10s for numerical solution depending on grid size",
    "benchmarks": {
      "analytical_rectangular": "80ms for 50\u00d750 mode expansion",
      "analytical_disk": "60ms for 100 Fourier modes",
      "finite_difference_2d": "200ms for 100\u00d7100 grid (iterative solver)",
      "finite_element_2d": "2s for 10000 elements with adaptive refinement"
    }
  }
}