{
  "topic": "pde.heat-equation",
  "title": "The Heat Equation",
  "description": "The heat equation is a fundamental parabolic PDE describing heat diffusion and\nother diffusion processes. It models how temperature distributes over time and space.\n",
  "mathematical_definition": "$$\\frac{\\partial u}{\\partial t} = \\alpha \\nabla^2 u$$\n\nwhere $u(x,t)$ is temperature, $\\alpha$ is thermal diffusivity, and $\\nabla^2$ is the Laplacian.\n\nIn 1D: $$\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}$$\n",
  "code_refs": {
    "rust": "mathhook_core::pde::heat_equation",
    "python": "mathhook.pde.heat_equation",
    "nodejs": "mathhook.pde.heatEquation"
  },
  "quick_reference": {
    "standard_form": "$\\frac{\\partial u}{\\partial t} = \\alpha \\nabla^2 u$",
    "type": "Parabolic PDE (second-order in space, first-order in time)",
    "principle": "Heat flows from hot to cold regions",
    "solution_methods": [
      "Separation of variables (for simple geometries)",
      "Fourier series expansion",
      "Fundamental solution (Green's function)",
      "Numerical methods (finite difference, finite element)"
    ],
    "key_properties": [
      "Maximum principle: temperature cannot have interior extrema",
      "Smoothing effect: solutions become infinitely smooth for $t > 0$",
      "Irreversibility: cannot uniquely determine initial conditions from final state"
    ]
  },
  "examples": [
    {
      "title": "1D Heat Equation with Dirichlet Boundary Conditions",
      "explanation": "Solve the heat equation on a rod of length $L$ with fixed temperatures\nat both ends:\n\nPDE: $\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}$, $0 < x < L$, $t > 0$\n\nBoundary conditions: $u(0,t) = 0$, $u(L,t) = 0$\n\nInitial condition: $u(x,0) = f(x)$\n\nSolution using separation of variables:\n$$u(x,t) = \\sum_{n=1}^{\\infty} b_n \\sin\\left(\\frac{n\\pi x}{L}\\right) e^{-\\alpha (n\\pi/L)^2 t}$$\n\nwhere $b_n = \\frac{2}{L}\\int_0^L f(x)\\sin\\left(\\frac{n\\pi x}{L}\\right)dx$\n",
      "code": {
        "python": "from mathhook import pde, symbols, expr\n\n# Define variables\nx, t, L, alpha = symbols('x t L alpha')\nu = pde.Function('u', [x, t])\n\n# Define PDE\nheat_eq = pde.heat_equation(u, x, t, alpha)\n\n# Boundary conditions\nbc1 = u.subs(x, 0) == 0\nbc2 = u.subs(x, L) == 0\n\n# Initial condition (example: sine wave)\nic = u.subs(t, 0) == expr('sin(pi*x/L)')\n\n# Solve using separation of variables\nsolution = pde.solve_heat_equation(\n    heat_eq,\n    boundary_conditions=[bc1, bc2],\n    initial_condition=ic,\n    domain={'x': (0, L), 't': (0, float('inf'))},\n    method='separation_of_variables'\n)\n\nprint(f\"Solution: {solution}\")\n# Result: sum of exponentially decaying sine modes\n",
        "rust": "use mathhook::pde::*;\nuse mathhook::{expr, symbol};\n\n// Define variables\nlet x = symbol!(x);\nlet t = symbol!(t);\nlet L = symbol!(L);\nlet alpha = symbol!(alpha);\n\n// Create heat equation\nlet heat_eq = HeatEquation::new(alpha);\n\n// Define boundary conditions\nlet bc = BoundaryConditions::dirichlet(vec![\n    (expr!(0), expr!(0)),  // u(0,t) = 0\n    (L.clone(), expr!(0)), // u(L,t) = 0\n]);\n\n// Define initial condition\nlet ic = InitialCondition::new(expr!(sin(pi * x / L)));\n\n// Solve\nlet solution = heat_eq.solve_separation_variables(\n    &bc,\n    &ic,\n    Domain::rectangular((expr!(0), L), (expr!(0), expr!(inf)))\n);\n\nprintln!(\"Solution: {}\", solution);\n",
        "nodejs": "const { pde, symbols, expr } = require('mathhook');\n\n// Define variables\nconst [x, t, L, alpha] = symbols('x', 't', 'L', 'alpha');\nconst u = pde.function('u', [x, t]);\n\n// Create heat equation\nconst heatEq = pde.heatEquation(u, x, t, alpha);\n\n// Boundary conditions\nconst bc1 = u.subs(x, 0).eq(0);\nconst bc2 = u.subs(x, L).eq(0);\n\n// Initial condition\nconst ic = u.subs(t, 0).eq(expr('sin(pi*x/L)'));\n\n// Solve\nconst solution = pde.solveHeatEquation(heatEq, {\n  boundaryConditions: [bc1, bc2],\n  initialCondition: ic,\n  domain: { x: [0, L], t: [0, Infinity] },\n  method: 'separationOfVariables'\n});\n\nconsole.log(`Solution: ${solution}`);\n"
      },
      "expected_output": "$$u(x,t) = \\frac{2}{L}\\sum_{n=1}^{\\infty} \\left(\\int_0^L \\sin\\left(\\frac{m\\pi x}{L}\\right)\\sin\\left(\\frac{n\\pi x}{L}\\right)dx\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) e^{-\\alpha (n\\pi/L)^2 t}$$\n\nFor initial condition $u(x,0) = \\sin(\\pi x/L)$, only $n=1$ term survives:\n$$u(x,t) = \\sin\\left(\\frac{\\pi x}{L}\\right) e^{-\\alpha (\\pi/L)^2 t}$$\n"
    },
    {
      "title": "2D Heat Equation on Rectangle",
      "explanation": "Solve the 2D heat equation on a rectangular domain $[0,a] \\times [0,b]$\nwith zero boundary conditions.\n\nPDE: $\\frac{\\partial u}{\\partial t} = \\alpha \\left(\\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2}\\right)$\n\nSolution:\n$$u(x,y,t) = \\sum_{m=1}^{\\infty}\\sum_{n=1}^{\\infty} b_{mn} \\sin\\left(\\frac{m\\pi x}{a}\\right)\\sin\\left(\\frac{n\\pi y}{b}\\right) e^{-\\alpha\\left[(m\\pi/a)^2 + (n\\pi/b)^2\\right]t}$$\n",
      "code": {
        "python": "from mathhook import pde, symbols\n\nx, y, t, a, b, alpha = symbols('x y t a b alpha')\nu = pde.Function('u', [x, y, t])\n\n# 2D heat equation\nheat_eq_2d = pde.heat_equation_2d(u, x, y, t, alpha)\n\n# Zero boundary conditions on rectangle\nbc = pde.BoundaryConditions.dirichlet_rectangle(\n    x_range=(0, a),\n    y_range=(0, b),\n    value=0\n)\n\n# Initial condition (example: product of sines)\nic = u.at(t=0) == expr('sin(pi*x/a) * sin(pi*y/b)')\n\nsolution = pde.solve_heat_equation_2d(\n    heat_eq_2d,\n    boundary_conditions=bc,\n    initial_condition=ic,\n    method='separation_of_variables'\n)\n",
        "rust": "use mathhook::pde::*;\n\nlet [x, y, t, a, b, alpha] = symbols![x, y, t, a, b, alpha];\n\nlet heat_eq = HeatEquation2D::new(alpha);\n\nlet bc = BoundaryConditions::dirichlet_rectangle(\n    (expr!(0), a.clone()),\n    (expr!(0), b.clone()),\n    expr!(0)\n);\n\nlet ic = expr!(sin(pi * x / a) * sin(pi * y / b));\n\nlet solution = heat_eq.solve_separation_variables(&bc, &ic);\n",
        "nodejs": "const { pde, symbols, expr } = require('mathhook');\n\nconst [x, y, t, a, b, alpha] = symbols('x', 'y', 't', 'a', 'b', 'alpha');\n\nconst solution = pde.solveHeatEquation2D({\n  alpha,\n  domain: { x: [0, a], y: [0, b] },\n  boundaryConditions: 'dirichlet_zero',\n  initialCondition: expr('sin(pi*x/a) * sin(pi*y/b)')\n});\n"
      },
      "expected_output": "For $u(x,y,0) = \\sin(\\pi x/a)\\sin(\\pi y/b)$:\n$$u(x,y,t) = \\sin\\left(\\frac{\\pi x}{a}\\right)\\sin\\left(\\frac{\\pi y}{b}\\right) e^{-\\alpha\\left[(\\pi/a)^2 + (\\pi/b)^2\\right]t}$$\n"
    },
    {
      "title": "Fundamental Solution (Green's Function)",
      "explanation": "The fundamental solution of the 1D heat equation is:\n$$G(x,t) = \\frac{1}{\\sqrt{4\\pi\\alpha t}} e^{-x^2/(4\\alpha t)}$$\n\nThis is the solution with initial condition $u(x,0) = \\delta(x)$ (Dirac delta).\n\nFor arbitrary initial condition $f(x)$, the solution is:\n$$u(x,t) = \\int_{-\\infty}^{\\infty} G(x-y,t)f(y)dy = \\frac{1}{\\sqrt{4\\pi\\alpha t}} \\int_{-\\infty}^{\\infty} e^{-(x-y)^2/(4\\alpha t)} f(y)dy$$\n",
      "code": {
        "python": "from mathhook import pde, symbols, expr\nimport numpy as np\n\nx, t, alpha = symbols('x t alpha')\n\n# Fundamental solution\nG = pde.heat_kernel(x, t, alpha)\nprint(f\"Green's function: {G}\")\n# Result: 1/sqrt(4*pi*alpha*t) * exp(-x^2/(4*alpha*t))\n\n# Solution for initial condition f(x)\ndef solve_with_convolution(f_func, x_val, t_val, alpha_val):\n    \"\"\"Solve heat equation using convolution with Green's function\"\"\"\n    from scipy.integrate import quad\n\n    def integrand(y):\n        kernel = (1/np.sqrt(4*np.pi*alpha_val*t_val)) * \\\n                 np.exp(-(x_val - y)**2 / (4*alpha_val*t_val))\n        return kernel * f_func(y)\n\n    result, error = quad(integrand, -np.inf, np.inf)\n    return result\n\n# Example: Gaussian initial condition\nf = lambda x: np.exp(-x**2)\nu_at_point = solve_with_convolution(f, x_val=0.5, t_val=0.1, alpha_val=1.0)\nprint(f\"u(0.5, 0.1) = {u_at_point}\")\n",
        "rust": "use mathhook::pde::*;\n\nlet [x, t, alpha] = symbols![x, t, alpha];\n\n// Fundamental solution\nlet greens = HeatEquation::fundamental_solution(x, t, alpha);\n// Result: 1/sqrt(4*pi*alpha*t) * exp(-x^2/(4*alpha*t))\n\n// Solve with convolution\nlet initial_condition = expr!(exp(-x^2));\nlet solution = HeatEquation::convolve_with_kernel(\n    greens,\n    initial_condition,\n    alpha\n);\n",
        "nodejs": "const { pde, symbols, expr } = require('mathhook');\n\nconst [x, t, alpha] = symbols('x', 't', 'alpha');\n\n// Fundamental solution\nconst G = pde.heatKernel(x, t, alpha);\nconsole.log(`Green's function: ${G}`);\n\n// Convolution solution\nconst ic = expr('exp(-x^2)');\nconst solution = pde.convolveHeatKernel(G, ic, { x, t, alpha });\n"
      },
      "expected_output": "Green's function:\n$$G(x,t) = \\frac{1}{\\sqrt{4\\pi\\alpha t}} e^{-x^2/(4\\alpha t)}$$\n\nFor $f(x) = e^{-x^2}$:\n$$u(x,t) = \\frac{1}{\\sqrt{1+4\\alpha t}} e^{-x^2/(1+4\\alpha t)}$$\n"
    }
  ],
  "article": {
    "sections": [
      {
        "heading": "Physical Interpretation",
        "content": "The heat equation models diffusion processes where:\n\n- **$u(x,t)$**: Temperature at position $x$ and time $t$\n- **$\\alpha$**: Thermal diffusivity (material property)\n- **$\\nabla^2 u$**: Laplacian measures spatial curvature of temperature\n\n**Physical principle**: Heat flows from regions of high curvature to low curvature,\nsmoothing out temperature variations over time.\n\n**Examples beyond heat transfer**:\n- Diffusion of chemicals in solution\n- Spread of biological populations\n- Option pricing in finance (Black-Scholes equation)\n- Image processing (Gaussian blur)\n"
      },
      {
        "heading": "Separation of Variables Method",
        "content": "For simple geometries with homogeneous boundary conditions:\n\n**Step 1**: Assume $u(x,t) = X(x)T(t)$\n\n**Step 2**: Substitute into PDE:\n$$X(x)T'(t) = \\alpha X''(x)T(t)$$\n\n**Step 3**: Separate variables:\n$$\\frac{T'(t)}{\\alpha T(t)} = \\frac{X''(x)}{X(x)} = -\\lambda$$\n\nwhere $\\lambda$ is the separation constant.\n\n**Step 4**: Solve two ODEs:\n- Spatial: $X''(x) + \\lambda X(x) = 0$ with boundary conditions\n- Temporal: $T'(t) + \\alpha\\lambda T(t) = 0$\n\n**Step 5**: Find eigenvalues $\\lambda_n$ and eigenfunctions $X_n(x)$ from spatial problem\n\n**Step 6**: General solution is superposition:\n$$u(x,t) = \\sum_{n} c_n X_n(x) e^{-\\alpha\\lambda_n t}$$\n\n**Step 7**: Determine coefficients $c_n$ from initial condition using orthogonality\n"
      },
      {
        "heading": "Fourier Series Solutions",
        "content": "For 1D heat equation on $[0,L]$ with Dirichlet boundary conditions:\n\n**Eigenvalues**: $\\lambda_n = (n\\pi/L)^2$, $n = 1,2,3,...$\n\n**Eigenfunctions**: $X_n(x) = \\sin(n\\pi x/L)$\n\n**General solution**:\n$$u(x,t) = \\sum_{n=1}^{\\infty} b_n \\sin\\left(\\frac{n\\pi x}{L}\\right) e^{-\\alpha (n\\pi/L)^2 t}$$\n\n**Fourier coefficients** from initial condition $f(x)$:\n$$b_n = \\frac{2}{L}\\int_0^L f(x)\\sin\\left(\\frac{n\\pi x}{L}\\right)dx$$\n\n**Key observations**:\n- Higher frequency modes ($n$ large) decay faster\n- Long-time behavior dominated by $n=1$ mode\n- Solution becomes smoother as $t \\to \\infty$\n"
      },
      {
        "heading": "Maximum Principle",
        "content": "**Strong Maximum Principle**: If $u(x,t)$ solves the heat equation in a region,\nthen the maximum and minimum of $u$ occur either:\n1. At the initial time ($t = 0$)\n2. On the spatial boundary\n\n**Physical interpretation**: Temperature cannot have local maxima or minima in the\ninterior of the domain - heat always flows to eliminate temperature extremes.\n\n**Consequences**:\n- Uniqueness of solutions\n- Comparison principles for solutions\n- Stability estimates\n- Temperature bounds from boundary data\n"
      },
      {
        "heading": "Fundamental Solution and Green's Function",
        "content": "The fundamental solution (heat kernel) is:\n$$G(x,t) = \\frac{1}{(4\\pi\\alpha t)^{n/2}} e^{-|x|^2/(4\\alpha t)}$$\n\nwhere $n$ is the spatial dimension.\n\n**Properties**:\n- $G(x,t) \\to \\delta(x)$ as $t \\to 0^+$\n- $\\int G(x,t)dx = 1$ for all $t > 0$ (conservation)\n- Gaussian spreading with variance $\\sigma^2 = 2\\alpha t$\n\n**Convolution solution** for initial value problem:\n$$u(x,t) = \\int G(x-y,t)f(y)dy$$\n\nThis represents the superposition of heat kernels centered at each point of the\ninitial distribution.\n"
      },
      {
        "heading": "Numerical Methods",
        "content": "**Finite Difference Methods**:\n\nExplicit (Forward Euler):\n$$u_i^{n+1} = u_i^n + \\frac{\\alpha \\Delta t}{(\\Delta x)^2}(u_{i+1}^n - 2u_i^n + u_{i-1}^n)$$\n\nStability condition: $\\frac{\\alpha \\Delta t}{(\\Delta x)^2} \\leq \\frac{1}{2}$\n\nImplicit (Backward Euler):\n$$u_i^{n+1} - \\frac{\\alpha \\Delta t}{(\\Delta x)^2}(u_{i+1}^{n+1} - 2u_i^{n+1} + u_{i-1}^{n+1}) = u_i^n$$\n\nUnconditionally stable, requires solving linear system.\n\nCrank-Nicolson (average of explicit and implicit):\nBetter accuracy, unconditionally stable.\n\n**Finite Element Methods**: Handle complex geometries and boundary conditions.\n\n**Spectral Methods**: Exponential convergence for smooth solutions.\n"
      }
    ]
  },
  "use_cases": [
    "Heat conduction: Temperature distribution in solids",
    "Chemical diffusion: Concentration of reactants spreading in solution",
    "Financial mathematics: Black-Scholes equation for option pricing",
    "Image processing: Gaussian smoothing and edge detection",
    "Biology: Population spread and chemical signaling",
    "Materials science: Grain growth and phase transitions"
  ],
  "related_topics": [
    "pde.wave-equation",
    "pde.laplace-equation",
    "pde.diffusion-advection",
    "calculus.fourier-series",
    "numerical.finite-difference"
  ],
  "references": [
    {
      "title": "Partial Differential Equations",
      "author": "Lawrence C. Evans",
      "year": 2010,
      "publisher": "American Mathematical Society"
    },
    {
      "title": "The Heat Equation",
      "author": "D.V. Widder",
      "year": 1975,
      "publisher": "Academic Press"
    },
    {
      "title": "Fourier Series and Boundary Value Problems",
      "author": "James Ward Brown and Ruel V. Churchill",
      "year": 2011,
      "publisher": "McGraw-Hill"
    }
  ],
  "performance": {
    "complexity": "O(n\u00b3) for separation of variables with n modes, O(mn) for numerical finite difference with m time steps and n spatial points",
    "typical_time": "< 100ms for analytical solution with 50 Fourier modes, 1-10s for numerical solution on 100\u00d7100 grid",
    "benchmarks": {
      "analytical_1d": "50ms for 100 Fourier modes",
      "numerical_explicit": "200ms for 100 spatial points, 1000 time steps",
      "numerical_implicit": "1.5s for 100\u00d7100 2D grid, 500 time steps"
    }
  }
}